<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204142" />

<meta name="date" content="2024-12-08" />

<title>All homework answers of SA24204142</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All homework answers of SA24204142</h1>
<h4 class="author">SA24204142</h4>
<h4 class="date">2024-12-08</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">library</span>(SA24204142)</span></code></pre></div>
<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>复现讲义中的Example 3.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>ctl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.17</span>, <span class="fl">5.58</span>, <span class="fl">5.18</span>, <span class="fl">6.11</span>, <span class="fl">4.50</span>, <span class="fl">4.61</span>, <span class="fl">5.17</span>, <span class="fl">4.53</span>, <span class="fl">5.33</span>, <span class="fl">5.14</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.81</span>, <span class="fl">4.17</span>, <span class="fl">4.41</span>, <span class="fl">3.59</span>, <span class="fl">5.87</span>, <span class="fl">3.83</span>, <span class="fl">6.03</span>, <span class="fl">4.89</span>, <span class="fl">4.32</span>, <span class="fl">4.69</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(ctl, trt)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Ctl&quot;</span>, <span class="st">&quot;Trt&quot;</span>))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>lm.D9 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">2.5</span>, <span class="dv">2</span>))</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">plot</span>(lm.D9)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>对R自带数据集iris进行kmeans聚类.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<p>下面是代码实现：</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240910</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>ir <span class="ot">=</span> iris[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>myclust <span class="ot">=</span> <span class="fu">kmeans</span>(<span class="at">x=</span>ir, <span class="at">centers=</span><span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">100</span>) <span class="co"># 分为3类，迭代100次</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>labels <span class="ot">=</span> myclust<span class="sc">$</span>cluster</span></code></pre></div>
<p>聚类效果如下表：</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>targets <span class="ot">=</span> <span class="fu">t</span>(iris[<span class="dv">5</span>])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">table</span>(targets, labels)</span></code></pre></div>
<pre><code>##             labels
## targets       1  2  3
##   setosa      0  0 50
##   versicolor  2 48  0
##   virginica  36 14  0</code></pre>
<p>可见错分率约为10.7%.</p>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>生成概率密度为<span class="math display">\[p(x)=\frac{1}{2}e^{-|x|}\]</span>的随机数.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>可以使用逆变换法. 通过简单计算可知上述密度函数对应的分布函数为 <span class="math display">\[F(x)=\int_{-\infty}^x\frac{1}{2}e^{-|t|}\mathrm{d}t=\begin{cases}
  \frac{1}{2}e^x &amp; x\le 0\\
  1-\frac{1}{2}e^{-x} &amp; x &gt; 0
\end{cases}.\]</span> 其逆映射为 <span class="math display">\[F^{-1}(x)=
\begin{cases}
  \log(2x) &amp; 0&lt;x\le \frac{1}{2}\\
  -\log(2-2x) &amp; \frac{1}{2}&lt;x&lt;1
\end{cases}.\]</span> 取<span class="math inline">\(U\sim
U(0,1)\)</span>，那么<span class="math inline">\(F^{-1}(U)\)</span>服从目标分布.</p>
<p>下面是对应的代码实现：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240910</span>, <span class="at">kind=</span><span class="cn">NULL</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u)<span class="sc">*</span>(u<span class="sc">&lt;=</span><span class="fl">0.5</span>) <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u)<span class="sc">*</span>(u<span class="sc">&gt;</span><span class="fl">0.5</span>)</span></code></pre></div>
<p>下图是实验结果，柱状图为生成的随机数的频率图，红线为目标分布的密度函数.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>DensityFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">curve</span>(DensityFunction, <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>可见生成的效果很好.</p>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="question-1-exercise-3.4" class="section level2">
<h2>Question 1: Exercise 3.4</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\quad
x\ge 0,\sigma&gt;0.\]</span> Develop an algorithm to generate random
samples from a Rayleigh(σ) distribution.</p>
<p>Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and
check that the mode of the generated samples is close to the theoretical
mode σ (check the histogram).</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div id="算法" class="section level3">
<h3>1.算法</h3>
<p>下面使用逆变换法来生成样本. 目标分布为 <span class="math display">\[F(x)=\int_{0}^x\frac{t}{\sigma^2}e^{-t^2/(2\sigma^2)}\mathrm{d}t=1-e^{-x^2/(2\sigma^2)},\quad
x\ge0.\]</span> 其逆为 <span class="math display">\[F^{-1}(x)=\sqrt{-2\sigma^2\ln(1-x)}.\]</span>
因此算法如下：</p>
<ol style="list-style-type: decimal">
<li><p>生成<span class="math inline">\(U\sim U(0,1)\)</span>.</p></li>
<li><p>输出<span class="math inline">\(X=F^{-1}(U)\)</span>.</p></li>
</ol>
</div>
<div id="验证" class="section level3">
<h3>2.验证</h3>
<p>接下来我分别考察<span class="math inline">\(\sigma = 0.1, 1,
10\)</span>的情况，每种情况生成10000个随机数.</p>
<p>上述算法的代码实现如下：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>RayleighGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="co"># n: 生成的随机数数目</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="co"># sigma: 目标分布中的参数sigma</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="co"># return: 一个长度为n的向量</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="co"># 1. 生成均匀分布随机数U</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="co"># 2. 输出X=F^{-1}(U)</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>U))</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>}</span></code></pre></div>
<p>下面是不同<span class="math inline">\(\sigma\)</span>取值下的实验结果：</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>   <span class="co"># 生成随机数数目</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240920</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">RayleighGenerator</span>(n, sigmas[<span class="dv">1</span>])</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">RayleighGenerator</span>(n, sigmas[<span class="dv">2</span>])</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">RayleighGenerator</span>(n, sigmas[<span class="dv">3</span>])</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># 整成dataframe用于画图</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X1)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X2)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X3)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># 目标分布的密度</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>TargetDensityGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma) {</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  target <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="fu">return</span>(</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>      ( x <span class="sc">/</span> (sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)) ) <span class="sc">*</span> ( x <span class="sc">&gt;</span> <span class="dv">0</span> )</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>    )</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  }</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">return</span>(target)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># 画图函数</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, sigma) {</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="co"># data: 生成的随机数，必须是dataframe，只有一列，名为&quot;X&quot;</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="co"># sigma: 目标分布的参数</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="co"># return: 一个ggplot图，带有data决定的直方图和sigma决定的目标密度曲线</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(data)[<span class="dv">1</span>]</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>X)) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>                   <span class="at">binwidth=</span><span class="fl">3.5</span><span class="sc">*</span>sigma<span class="sc">/</span>(n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>                   <span class="at">fill=</span><span class="st">&#39;#74c0fc&#39;</span>, </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>                   <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span>   </span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    <span class="co"># 使用Scott法选取binwidth，经我计算Rayleigh分布的方差就是sigma^2</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="fu">TargetDensityGenerator</span>(sigma), <span class="at">color =</span> <span class="st">&#39;#fd7e14&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>sigma, <span class="at">linetype=</span><span class="dv">2</span>, <span class="at">linewidth=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>    <span class="co"># Rayleigh分布的众数就是sigma</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>         <span class="at">title=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span>. (sigma))) <span class="sc">+</span>   <span class="co"># 动态生成标题</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  </span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  <span class="fu">return</span>(Figure)</span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>Figure1 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data1, sigmas[<span class="dv">1</span>])</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>Figure2 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data2, sigmas[<span class="dv">2</span>])</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>Figure3 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data3, sigmas[<span class="dv">3</span>])</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>Figure1 <span class="sc">+</span> Figure2 <span class="sc">+</span> Figure3</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>其中橙色曲线为目标密度函数，虚线表示的是理论众数，可见样本众数和理论众数是十分相近的，样本分布和目标分布也是极为相近.</p>
</div>
</div>
<div id="question-2-exercise-3.11" class="section level2">
<h2>Question 2: Exercise 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The components of the mixture have <span class="math inline">\(N(0,
1)\)</span> and <span class="math inline">\(N(3, 1)\)</span>
distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =
1 − p_1\)</span>.</p>
<p>Graph the histogram of the sample with density superimposed, for
<span class="math inline">\(p_1 = 0.75\)</span>.</p>
<p>Repeat with different values for p1 and observe whether the empirical
distribution of the mixture appears to be bimodal. Make a conjecture
about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div id="算法-1" class="section level3">
<h3>1.算法</h3>
<p>这是个混合模型，生成随机数的算法如下：</p>
<ol style="list-style-type: decimal">
<li><p>生成一个独立的潜变量<span class="math inline">\(I\)</span>其满足<span class="math inline">\(P(I=0)=p_1,\ P(I=1)=p_2\)</span>.</p></li>
<li><p>若<span class="math inline">\(I=0\)</span>，则从<span class="math inline">\(N(0, 1)\)</span>中生成<span class="math inline">\(X\)</span>. 若<span class="math inline">\(I=1\)</span>，则从<span class="math inline">\(N(3,
1)\)</span>中生成<span class="math inline">\(X\)</span>.</p></li>
<li><p>输出<span class="math inline">\(X\)</span>.</p></li>
</ol>
<p>上述算法的代码实现如下：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>MixNormGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, p) {</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  <span class="co"># n: 生成的随机数数目</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="co"># p: p1的取值</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="co"># return: 一个长度为n的向量</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  </span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="co"># 1.生成潜变量I</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(p, <span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  </span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="co"># 2.从两个分量中采样</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  </span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="co"># 3.输出X</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  X <span class="ot">&lt;-</span> X1 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>I) <span class="sc">+</span> X2 <span class="sc">*</span> I</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="画直方图和目标密度" class="section level3">
<h3>2.画直方图和目标密度</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 这里写一个函数根据p1输出目标密度函数，方便后面画图的时候调用</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>TargetDensityGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(p1) {</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  target <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="fu">return</span>(p1<span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  }</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math inline">\(p_1=0.75\)</span>时的实验结果如下，橙色曲线为目标密度，可见生成的效果不错.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240921</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, p1)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>X)) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                 <span class="at">binwidth=</span><span class="fl">3.5</span><span class="sc">*</span><span class="fu">sd</span>(data<span class="sc">$</span>X)<span class="sc">/</span>(n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                 <span class="at">fill=</span><span class="st">&#39;#74c0fc&#39;</span>, </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                 <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="fu">TargetDensityGenerator</span>(p1), <span class="at">color =</span> <span class="st">&#39;#fd7e14&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>       <span class="at">title=</span><span class="fu">bquote</span>(p[<span class="dv">1</span>] <span class="sc">==</span>. (p1))) <span class="sc">+</span>  </span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>Figure</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZmY6ZpA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmtttmtv9uTU1uTW5uTY5ubqtuq+R0wPyOTU2OTW6OTY6OyP+QOgCQtmaQtpCQttuQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq22/+2/9u2///Ijk3I///bkDrbtmbb/7bb///kq27k///9fhT/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///+29ch2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKRElEQVR4nO3da2PbNBQG4HRsJdxpdinQDuZBwyiXFca6wDanJWnm//+LsHyJ5UTykeQj6dg574fWaa06eSrJd3mScTozif0GqIeBgDAQEAYCwkBAGAgIAwFhICBDAfrv28nk81fVi9vppMjRZZZdFVMn3hY8EKD1qWC497p8JQFt5gwksph8/XbzV9thKV7eTs/8Ljk+0Pr0ZDmd3L/smmczf/C2/tqUE6+WR50F+4cC0JfTqj/pmOdYfLuq21jxoiixuPczpNsvFIAmx6L5HHfMczstGtdCUrydlmZlb+SvnVEAKhpOq3ZsP3jV/SqAygq0mR/9kmX/TOS2hxsKQEVVWHS1sX2gqlSVK389ETGg209fq+cpgKRatmy1qk7dfqEAVK6hxIdfbjd12k1sfy1WWVVVa6d9YoYCULmNcyxaygt1Dcq98nn+bLaDaqu8D/ouA3r4fqEA9NF0u5WsaWLSlnTZtrZd0HK7z+EpFICO8w3Fr8r9LB1QsS92X8xTAlVNS0zlv/jilboQRkgANS+0QNHCQEAYCAgDAYkPRDwMBISBgDAQEAYCwkBAGAgIAwFhICAMBMQe6OMDiTuQdYlBhoGAMBAQBgLCQEAYCIgB0N3z2eP3xdTNbPbozW7JkQcG+vDrRfbuiZhaff+mmpJLjjww0N1PbwqaMs0UKlCaB/Pv4QUGWv3wPrv78WX1qqxB8iYmSlKyQjDQzeMGaHX+sJZCrUECh6iQbQ1qphCBSpqhArX7oOz6YqckQioZkkIma7FnVc8jNzZMoC0MRSHj7aBiHT+beeiDJBaCQvG3pGUUBlKEgbqTtoHICREA0r+iEHJA1IRiA+2KMNBOdkEYaCc5SCKFXhuLDJTuApGrQtGBsj0gWkLkgKhVobhAKQN1p8BgIH3UQKSE6AERq0JRgVIG6k5JsQ9ESYggEK0qxEBAIgEVGnlbEiYMpEgFlGiACAlRBCJVhRgISESgtAOIjlBUoEQDRKkKMRAQakBJ0zv1+ft4iQeUdgKlDFT5KIESBmKg7jAQkKYL0gGlDJR0ACUMxECdYSAgDASk6aO1QET2NuIB7Zm0XzAQA3WFgYCkBkA0hKIBKUzaLxiIgTrCQECMgEgIxQFKDYCIVKFYQGoTBqrCQEAMgSgIEQaicXYsCpDsw0CKMBCQkQE1o7+szmez+rb5IEAEhGxGfxH3zK+eItw3bwhEogrZjLxwI5gQRl5o3wI1eCDV2B39Rn8ZGVBrQAoxTsVOSftYAMUXsqtBd8+3PiGAKFQhq9FfVucXzc/9A8knz6LFZvSXlo870M5NdIMHakZ/eTcT6b0WswJKBwAElLSOBVDCQIMEWp+aPKfrgIGKB+eBz5t0Bdq9y3CQQOWj4LofnBwEaHsxdbTo+yBB1PVMRWug6nMX12cOH2gxKZ7G2NHQDhlIPJu8eHzpsqMKHTDQ+tTkcaUHDQRWn4yBGKjMPtCifngw8NjbgwXa1iDDksZxBErpAdmVNE7jYwGUkAPKq0/5QOXuzcTDBbIuaRwGAuIKFPf+VSVQ2cyArcVAQLFv8FUCXR1ni3uvFz5W8/uDCQwQKK9Am/mxnw1FF6Cot2dqgNanJ1SAIt+/qgLazE+WR5eioZmUNM54gLLbab6b0XUsSC5pnBEBWZU0TuNjCxTz7sMBAMW9PVPXxDztaowDSKzjzUsaZzxA/g53qEZ8MQGKeBWMugb5A+pw0P+CGhC0idguaZzxAPk7HuQMFE8o7GreEShmFQoKpBwSZ5BAi8nkbIG/q6EcjsIMKJqQ+njQg3/LIx4mJY3TAyhiFdIe7jjzcLiDgTrTDyiWkLKJLUQTE8fMTEoaRzNehxFQvEvK1Z30UmwGdfscNpBNSeP0BIokNBSgaFVIBVQ0sAm0w3qwQJt5sfZan2JvKGqGozAGiiOkuD6ogtnMkddi/YBiVaE9oOZgELCvcahAzeFE7A3FnkCRhMIB6YbEMQbKRg8EOwBAMYSGAlR8jXFniwJoe5UrPaAIl7yG25JGAIpxPV4woBQDKBk1kIEDDBT8crOBAYW/FsZqeJysHmFALmkYJKD9E/VpHbv3Yxqb4XGy7Gb2yBEoxQNKW39VjtU7MozV0BTXD/9wrUH64SgsgZLaYssi/9xBAIjl8DiVlP3wOHhASbvOtH/hZNAZy+FxnPsgRKDqeccVRusXHoTcapBc0igpMlCT9i/wK5FVH9QHSHuv/OCBmuFxMvpA+Lv8NsPjZEMAwhYKsyW9u77xCYQsFAooCwmEKTRCINwqNEYgVKEgQGlgIEyhQEDiKx4QLMdAEBCaUAigNBhQM4kmFAao+BYUKGEgCAhJaLRAWN1QAKA0DhDSmiwIUPk9OBCK0IiBcKqQfyDVwdFAQBhCIYCqieBAKFVo3EAIQt6B0ohAGEIBgOqpCEAIjWzsQL2F/AJJd2H2++yuQP2F/AOhfHYHoOp73wuKxg/U84Iiz0CaZzoHBEqoA+F89j5A/YZG8QtkcnW9b6CENhDSZ+8F1GtFdgBA/YS8AhldG+0fqJeQZyCszz5OILMrWw8aCO2zM5BXoD57ZB6BUjpAPYS8AuF99r5A7geGDgOotdPMQMpp1+dJHgyQ67Pc/AHtXNhKAMjpjldvQLtX3UUHcrwl2B9QRg3I7ZZgX0B7F5URAHK649UT0P4VLxSAXA5Q+wLKiAJZH170A6S8240AkMNNifhAiXpMWxpA9kI+gJQnU4kAJba3/noAUp9tpgJkK4QPpDlXSAbI8n4pdCDdqTBCQJlNJUIGSrUnMugAJdWt94nRNhEqUJrqj9OTAqqJwgLtD4VAGMi4s8YFEt+GAtSMAtIXqBkeRx4op2tDEf+zewGSRwHpAdQMjyMPlNMG8v7Z/QDVa7QuI5uhKVqDVIwDqJ7YWbtIvbfN4CbNlP3wOIONzfA4rYFyLIfHGWzcapBccuTB6YNGHJvhcVoD5TDQNs3wOEbbQSNLmLE7BhwGAsJAQHoAHUicgSDyIMXClWIgIAwEBA9opGEgIAwEhIGAMBAQDKDV+Wx2UUy9m82kwd07ozkl4GNR0rw2yyqDACSOpa2eFsfTri9MC+lOCXhYlDSvzbKqIADdPKnfw4ffXkIz19EdjvOwKGlem2VVQeqDyiOyeQWuWwAU3QFdD4uS5rVdVoYFJI45iuXntd/wX6s7JeBhUdK8lssS6Ql0PZs9Ef+iZ9KPjP6vrjXIYVHSvJFq0OpcfqNm79qtD3JalDRvnD6oedOiBn/43Wj5ulMCHhYlzWuzrCoIQGIrI+8ExX8mn3xoWIE1pwR8LKqa13JZVXhLGggDAWEgIAwEhIGAMBAQ8kDLiXhA7vq0+xHm/kIeqHx4+dVxrMXTBxKVB3i6ss/QB8p1/p6fwbN5ygCAsqvPojWwYQAtJ7F66GwQQOtvXnxyGW3pAwDK12DxVmIDABJrsNtptF6aPFC5ibiItp6nDrSZi+3EnKn4FiHUgaKHgYAwEBAGAsJAQBgICAMBYSAgDASEgYD8D5aMQD0ntfaAAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="观察双峰性并推测导致双峰的参数范围" class="section level3">
<h3>3.观察双峰性并推测导致双峰的参数范围</h3>
<p>考虑<span class="math inline">\(p_1\)</span>分别取<span class="math inline">\(0.1, 0.2,
0.3,\cdots,0.9\)</span>时的情况，实验结果如下图所示：</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240921</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">1</span>])</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">2</span>])</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">3</span>])</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">4</span>])</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>X5 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">5</span>])</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>X6 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">6</span>])</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>X7 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">7</span>])</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>X8 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">8</span>])</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>X9 <span class="ot">&lt;-</span> <span class="fu">MixNormGenerator</span>(n, ps[<span class="dv">9</span>])</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X1)</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X2)</span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X3)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a>data4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X4)</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>data5 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X5)</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>data6 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X6)</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a>data7 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X7)</span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>data8 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X8)</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>data9 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X9)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, p) {</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>X)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>                   <span class="at">binwidth=</span><span class="fl">3.5</span><span class="sc">*</span><span class="fu">sd</span>(data<span class="sc">$</span>X)<span class="sc">/</span>(n<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>                   <span class="at">fill=</span><span class="st">&#39;#74c0fc&#39;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>                   <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>         <span class="at">title=</span><span class="fu">bquote</span>(p[<span class="dv">1</span>] <span class="sc">==</span>. (p))) <span class="sc">+</span>   <span class="co"># 动态生成标题</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  <span class="fu">return</span>(Figure)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>Figure1 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data1, ps[<span class="dv">1</span>])</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>Figure2 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data2, ps[<span class="dv">2</span>])</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>Figure3 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data3, ps[<span class="dv">3</span>])</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>Figure4 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data4, ps[<span class="dv">4</span>])</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>Figure5 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data5, ps[<span class="dv">5</span>])</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>Figure6 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data6, ps[<span class="dv">6</span>])</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>Figure7 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data7, ps[<span class="dv">7</span>])</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>Figure8 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data8, ps[<span class="dv">8</span>])</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>Figure9 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data9, ps[<span class="dv">9</span>])</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>(Figure1<span class="sc">+</span>Figure2<span class="sc">+</span>Figure3)<span class="sc">/</span>(Figure4<span class="sc">+</span>Figure5<span class="sc">+</span>Figure6)<span class="sc">/</span>(Figure7<span class="sc">+</span>Figure8<span class="sc">+</span>Figure9)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>可见当<span class="math inline">\(p_1=0.3,0.4,0.5,0.6,0.7\)</span>时双峰非常明显，而<span class="math inline">\(p_1=0.2, 0.8\)</span>时双峰不明显，当<span class="math inline">\(p_1=0.1,0.9\)</span>时基本没有双峰现象.</p>
<p>因此我推断当<span class="math inline">\(p_1\in [0.3.
0.7]\)</span>时有双峰现象.</p>
</div>
</div>
<div id="question-3-exercise-3.20" class="section level2">
<h2>Question 3: Exercise 3.20</h2>
<p>A compound Poisson process is a stochastic process <span class="math inline">\(\{X(t), t \ge 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t) =
\sum_{i=1}^{N(t)}Y_i,\ t ≥ 0\)</span>, where <span class="math inline">\(\{N(t), t ≥ 0\}\)</span> is a Poisson process and
<span class="math inline">\(Y_1, Y_2,\dots\)</span> are iid and
independent of <span class="math inline">\(\{N(t), t ≥ 0\}\)</span>.</p>
<p>Write a program to simulate a compound Poisson(λ)–Gamma process (Y
has a Gamma distribution).</p>
<p>Estimate the mean and the variance of X(10) for several choices of
the parameters and compare with the theoretical values.</p>
<p>Hint: Show that <span class="math inline">\(E[X(t)] =
λtE[Y_1]\)</span> and <span class="math inline">\(Var(X(t)) =
λtE[Y_1^2]\)</span>.</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div id="算法-2" class="section level3">
<h3>1.算法</h3>
<p>任意给定<span class="math inline">\(t\ge0\)</span>，由于<span class="math inline">\(X(t)|N(t)=k\sim
Gamma(k*shape,rate)\)</span>，我给出如下算法生成<span class="math inline">\(X(t)\)</span>：</p>
<ol style="list-style-type: decimal">
<li><p>生成<span class="math inline">\(N\sim Poisson(\lambda
t)\)</span>.</p></li>
<li><p>输出<span class="math inline">\(X\sim Gamma(N*shape,
rate)\)</span>.</p></li>
</ol>
<p>代码实现如下：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>CPGPLocalGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, lambda, shape, rate, t){</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="co"># n: 生成的随机数数目</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>  <span class="co"># lambda: Poisson过程参数</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>  <span class="co"># shape, rate: Gamma分布参数</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>  <span class="co"># t: 时间参数</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>  <span class="co"># return: 一个长度为n的向量</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  </span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>  <span class="co"># remark: 这个函数只能生成X(t)的样本，不能生成一条轨道</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>  </span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>  <span class="co"># 1.生成N</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>t)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>  </span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>  <span class="co"># 2.输出X</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>N<span class="sc">*</span>shape, <span class="at">rate=</span>rate)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>}</span></code></pre></div>
<p>如果要生成一条轨道，由于此随机过程具有独立增量性，可以使用如下算法：</p>
<ol style="list-style-type: decimal">
<li><p>输入参数<span class="math inline">\(n\)</span>和<span class="math inline">\(step\)</span>，<span class="math inline">\(n\)</span>为样本点数目，<span class="math inline">\(step\)</span>为步长.</p></li>
<li><p>对于任意小于等于<span class="math inline">\(n\)</span>的非负整数<span class="math inline">\(i\)</span>，令<span class="math inline">\(t_i=i*setp\)</span>.</p></li>
<li><p>生成<span class="math inline">\(X\)</span>:</p>
<p>(1). <span class="math inline">\(X_0=0\)</span>.</p>
<p>(2). for i in 1:n :</p>
<ul>
<li><p>生成<span class="math inline">\(\Delta N\sim
Poisson(\lambda*step)\)</span>.</p></li>
<li><p>生成<span class="math inline">\(\Delta X\sim Gamma(shape*\Delta
N, rate)\)</span>.</p></li>
<li><p><span class="math inline">\(X_i=X_{i-1}+\Delta
X\)</span>.</p></li>
</ul></li>
<li><p>输出<span class="math inline">\(\{(t_i,X_i)\}_{i=0}^n\)</span>.</p></li>
</ol>
<p>其代码实现如下：</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>CPGPTraceGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, step, lambda, shape, rate) {</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="co"># n: 生成的样本点数，算上t=0的点，实际上输出的是n+1个点</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="co"># step: 步长</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>  <span class="co"># lambda: Poisson过程参数</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="co"># shape, rate: Gamma分布参数</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="co"># return: 一个(n+1)*2的dataframe，列名为&quot;t&quot;和&quot;X&quot;</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>  </span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>  <span class="co"># 生成t</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">0</span>, <span class="at">by=</span>step, <span class="at">length.out=</span>n<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>  <span class="co"># 生成X</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>  DeltaN <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda<span class="sc">*</span>step)</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>  DeltaX <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span>shape<span class="sc">*</span>DeltaN, <span class="at">rate=</span>rate)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">cumsum</span>(DeltaX))</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>  <span class="co"># 生成dataframe</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t=</span>t, <span class="at">X=</span>X)</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>  </span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="实验" class="section level3">
<h3>2.实验</h3>
<p>首先看看<span class="math inline">\(X(t)\)</span>的生成情况.
易见<span class="math inline">\(X(t)\)</span>非负，<span class="math inline">\(X(t)\)</span>的理论分布为 <span class="math display">\[F(x)=\sum_{k=0}^\infty P(X(t)\le
x|N(t)=k)=P(N(t)=0)+\sum_{k=1}^\infty P(X(t)\le x|N(t)=k)P(N(t)=k),
\quad x\ge 0.\]</span></p>
<p>可以看到<span class="math inline">\(F(x)\)</span>在<span class="math inline">\(x&gt;0\)</span>时是光滑的，此时的导数为 <span class="math display">\[f(x)=\sum_{k=1}^{\infty}\frac{rate^{k*shape}}{\Gamma(k*shape)}x^{k*shape-1}e^{-rate*x}\frac{(\lambda
t)^k}{k!}e^{-\lambda t},\quad x&gt;0.\]</span></p>
<p>接下来看看<span class="math inline">\(\lambda=1\)</span>，<span class="math inline">\(shape=1\)</span>，<span class="math inline">\(rate=1\)</span>时生成的随机数的情况，此时<span class="math inline">\(P(X(t)=0)=e^{-t}\)</span>，并且 <span class="math display">\[f(x)=\sum_{k=1}^\infty\frac{(tx)^k}{k!(k-1)!}x^{-1}e^{-x-t}.\]</span></p>
<p>可用<span class="math display">\[g(x)=\sum_{k=1}^{20}\frac{(tx)^k}{k!(k-1)!}x^{-1}e^{-x-t}\]</span>来估计<span class="math inline">\(f(x)\)</span>.</p>
<p>下面是<span class="math inline">\(t=1,3,10\)</span>的情况，每种情况生成10000个随机数，实验结果如下图：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240921</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">10</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">CPGPLocalGenerator</span>(n, lambda, shape, rate, ts[<span class="dv">1</span>])</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">CPGPLocalGenerator</span>(n, lambda, shape, rate, ts[<span class="dv">2</span>])</span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">CPGPLocalGenerator</span>(n, lambda, shape, rate, ts[<span class="dv">3</span>])</span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X1)</span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X2)</span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X3)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>TargetDensityGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  TargetDensity <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>      result <span class="ot">&lt;-</span> result <span class="sc">+</span> t<span class="sc">^</span>i <span class="sc">*</span> x<span class="sc">^</span>{i<span class="dv">-1</span>} <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">-</span>t) <span class="sc">/</span> (<span class="fu">factorial</span>(i) <span class="sc">*</span> <span class="fu">factorial</span>(i<span class="dv">-1</span>))</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>    }</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>    <span class="fu">return</span>(result)</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  }</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="fu">return</span>(TargetDensity)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>}</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>myplot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, t) {</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>  Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>X)) <span class="sc">+</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">bins=</span><span class="dv">50</span>, <span class="at">fill=</span><span class="st">&#39;#74c0fc&#39;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="fu">TargetDensityGenerator</span>(t), <span class="at">color =</span> <span class="st">&#39;#fd7e14&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;X(t)&quot;</span>, </span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>         <span class="at">y=</span><span class="st">&quot;Density&quot;</span>,</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>         <span class="at">title=</span><span class="fu">bquote</span>(t <span class="sc">==</span>. (t))) <span class="sc">+</span>  </span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>  <span class="fu">return</span>(Figure)</span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>Figure1 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data1, ts[<span class="dv">1</span>])</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>Figure2 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data2, ts[<span class="dv">2</span>])</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>Figure3 <span class="ot">&lt;-</span> <span class="fu">myplot</span>(data3, ts[<span class="dv">3</span>])</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>Figure1<span class="sc">+</span>Figure2<span class="sc">+</span>Figure3</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>橙色曲线即为<span class="math inline">\(g(x)\)</span>，可见生成的随机数在<span class="math inline">\(X(t)&gt;0\)</span>的时候效果很好.
而生成的随机数中<span class="math inline">\(0\)</span>的频率和<span class="math inline">\(P(X(t)=0)\)</span>的对比如下表：</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>freq <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sum</span>(X1<span class="sc">==</span><span class="dv">0</span>)<span class="sc">/</span>n, <span class="fu">sum</span>(X2<span class="sc">==</span><span class="dv">0</span>)<span class="sc">/</span>n, <span class="fu">sum</span>(X3<span class="sc">==</span><span class="dv">0</span>)<span class="sc">/</span>n)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>ts)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t=</span>ts, <span class="at">freq=</span>freq, <span class="at">prob=</span>prob)</span></code></pre></div>
<pre><code>##    t   freq         prob
## 1  1 0.3717 3.678794e-01
## 2  3 0.0503 4.978707e-02
## 3 10 0.0000 4.539993e-05</code></pre>
<p>可见二者的差异很小. 因此我所生成的随机数效果不错.</p>
<p>再看看<span class="math inline">\(\lambda=1\)</span>，<span class="math inline">\(shape=1\)</span>，<span class="math inline">\(rate=1\)</span>时生成的五条轨道：</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240921</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>shape <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">CPGPTraceGenerator</span>(n, step, lambda, shape, rate)</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">CPGPTraceGenerator</span>(n, step, lambda, shape, rate)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> <span class="fu">CPGPTraceGenerator</span>(n, step, lambda, shape, rate)</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>data4 <span class="ot">&lt;-</span> <span class="fu">CPGPTraceGenerator</span>(n, step, lambda, shape, rate)</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>data5 <span class="ot">&lt;-</span> <span class="fu">CPGPTraceGenerator</span>(n, step, lambda, shape, rate)</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t=</span>data1<span class="sc">$</span>t, <span class="at">X1=</span>data1<span class="sc">$</span>X, <span class="at">X2=</span>data2<span class="sc">$</span>X, <span class="at">X3=</span>data3<span class="sc">$</span>X, <span class="at">X4=</span>data4<span class="sc">$</span>X, <span class="at">X5=</span>data5<span class="sc">$</span>X)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x=</span>t)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>X1), <span class="at">color=</span><span class="st">&#39;#1F77B4FF&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>X2), <span class="at">color=</span><span class="st">&#39;#FF7F0EFF&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>X3), <span class="at">color=</span><span class="st">&#39;#2CA02CFF&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>X4), <span class="at">color=</span><span class="st">&#39;#D62728FF&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>X5), <span class="at">color=</span><span class="st">&#39;#9467BDFF&#39;</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) {x}, <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">linetype=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;t&quot;</span>, </span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;X&quot;</span>,</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&#39;Trajectory&#39;</span>) <span class="sc">+</span>   </span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>Figure</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>其中黑色虚线为<span class="math inline">\(E(X(t))\)</span>，彩色实线为生成的轨道.</p>
<p>目标随机过程是单增的，这些生成的轨道也都是单增的.
注意到轨迹形似阶梯函数，有很多与<span class="math inline">\(t\)</span>轴平行的线段，这和<span class="math inline">\(N(t)\)</span>是Poisson过程是相符的.
各轨道围绕在均值附近振动. 这都说明我所生成的轨道是合理的.</p>
</div>
<div id="估计" class="section level3">
<h3>3.估计</h3>
<p>易得 <span class="math display">\[E[X(t)]=E\left[E\left[X(t)|N(t)\right]\right]=E[N(t)E(Y_1)]=E(N(t))E(Y_1)=\lambda
tE(Y_1).\]</span></p>
<p>同理 <span class="math display">\[E[X(t)^2]=E\left[\sum_{i,j=1}^{N(t)}Y_iY_j\Bigg|N(t)\right]=E\left[N(t)E(Y_1^2)+(N(t)^2-N(t))(EY_1)^2\right]=\lambda
tE(Y_1^2)+(\lambda t)^2(EY_1)^2.\]</span></p>
<p>因此<span class="math inline">\(Var(X(t))=E(X(t)^2)-(E(x(t)))^2=\lambda t
E(Y_1^2)\)</span>.</p>
<p>根据Gamma分布的性质可知，<span class="math inline">\(E(Y_1)=shape/rate\)</span>，<span class="math inline">\(Var(Y_1)=shape/rate^2\)</span>，<span class="math inline">\(E(Y_1^2)=(shape+shape^2)/rate^2\)</span>.</p>
<p>下面就<span class="math inline">\(\lambda=0.1,1,10\)</span>，<span class="math inline">\(shape=1,2\)</span>，<span class="math inline">\(rate=1,2\)</span>的情况估计<span class="math inline">\(X(10)\)</span>的均值和方差，每组参数下生成10000个随机数，使用的估计量为样本均值和样本方差.</p>
<p>实验结果如下表：</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co"># 此函数用于生成不同参数下的理论值和估计值</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>Estimator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, lambdas, shapes, rates, t) {</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>  <span class="co"># n: 估计时所用样本数</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>  <span class="co"># lambdas: Poisson过程参数，一个任意长度的向量</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  <span class="co"># shapes, rates: Gamma分布参数，两个都是任意长度的向量</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  <span class="co"># t: 时间参数，只能输入一个正数</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="co"># return: 一个dataframe，各列分别为lambda, shape, rate, </span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>  <span class="co">#         theoretical_mean, estimated_mean, theoretical_variance, estimated_variance</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>  </span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>  estimated_mean <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  estimated_variance <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  theoretical_mean <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  theoretical_variance <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  </span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>  <span class="co"># 首先将lambdas, shapes, rates的取值的各种组合生成出来</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>  paras <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(lambdas, shapes, rates)</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>  <span class="fu">colnames</span>(paras) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;lambda&#39;</span>, <span class="st">&#39;shape&#39;</span>, <span class="st">&#39;rate&#39;</span>)</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>  </span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>  <span class="co"># 生成估计值和理论值</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(paras)) {</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>    Tmean <span class="ot">&lt;-</span> paras[i, ]<span class="sc">$</span>lambda <span class="sc">*</span> t <span class="sc">*</span> paras[i, ]<span class="sc">$</span>shape <span class="sc">/</span> paras[i, ]<span class="sc">$</span>rate</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>    Tvariance <span class="ot">&lt;-</span> paras[i, ]<span class="sc">$</span>lambda <span class="sc">*</span> t <span class="sc">*</span> (paras[i, ]<span class="sc">$</span>shape <span class="sc">+</span> paras[i, ]<span class="sc">$</span>shape<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (paras[i, ]<span class="sc">$</span>rate<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>    theoretical_mean <span class="ot">&lt;-</span> <span class="fu">c</span>(theoretical_mean, Tmean)</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>    theoretical_variance <span class="ot">&lt;-</span> <span class="fu">c</span>(theoretical_variance, Tvariance)</span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>    </span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">CPGPLocalGenerator</span>(n, paras[i, ]<span class="sc">$</span>lambda, paras[i, ]<span class="sc">$</span>shape, paras[i, ]<span class="sc">$</span>rate, t)</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>    estimated_mean <span class="ot">&lt;-</span> <span class="fu">c</span>(estimated_mean, <span class="fu">mean</span>(X))</span>
<span id="cb31-28"><a href="#cb31-28" tabindex="-1"></a>    estimated_variance <span class="ot">&lt;-</span> <span class="fu">c</span>(estimated_variance, <span class="fu">var</span>(X))</span>
<span id="cb31-29"><a href="#cb31-29" tabindex="-1"></a>  }</span>
<span id="cb31-30"><a href="#cb31-30" tabindex="-1"></a>  </span>
<span id="cb31-31"><a href="#cb31-31" tabindex="-1"></a>  <span class="co"># 生成dataframe</span></span>
<span id="cb31-32"><a href="#cb31-32" tabindex="-1"></a>  data <span class="ot">&lt;-</span> paras</span>
<span id="cb31-33"><a href="#cb31-33" tabindex="-1"></a>  data<span class="sc">$</span>theoretical_mean <span class="ot">&lt;-</span> theoretical_mean</span>
<span id="cb31-34"><a href="#cb31-34" tabindex="-1"></a>  data<span class="sc">$</span>estimated_mean <span class="ot">&lt;-</span> estimated_mean</span>
<span id="cb31-35"><a href="#cb31-35" tabindex="-1"></a>  data<span class="sc">$</span>theoretical_variance <span class="ot">&lt;-</span> theoretical_variance</span>
<span id="cb31-36"><a href="#cb31-36" tabindex="-1"></a>  data<span class="sc">$</span>eatimated_variance <span class="ot">&lt;-</span> estimated_variance</span>
<span id="cb31-37"><a href="#cb31-37" tabindex="-1"></a>  </span>
<span id="cb31-38"><a href="#cb31-38" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb31-39"><a href="#cb31-39" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240922</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>shapes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>rates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">Estimator</span>(n, lambdas, shapes, rates, t)</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">print</span>(data)</span></code></pre></div>
<pre><code>##    lambda shape rate theoretical_mean estimated_mean theoretical_variance
## 1     0.1     1    1              1.0      0.9709390                  2.0
## 2     1.0     1    1             10.0      9.9341948                 20.0
## 3    10.0     1    1            100.0    100.2994099                200.0
## 4     0.1     2    1              2.0      1.9789704                  6.0
## 5     1.0     2    1             20.0     19.9273085                 60.0
## 6    10.0     2    1            200.0    199.9127864                600.0
## 7     0.1     1    2              0.5      0.4924856                  0.5
## 8     1.0     1    2              5.0      5.0110995                  5.0
## 9    10.0     1    2             50.0     49.9842772                 50.0
## 10    0.1     2    2              1.0      1.0068288                  1.5
## 11    1.0     2    2             10.0     10.0593934                 15.0
## 12   10.0     2    2            100.0     99.9764885                150.0
##    eatimated_variance
## 1           1.9389681
## 2          19.6391534
## 3         202.8991460
## 4           5.8629514
## 5          61.8166171
## 6         597.7703624
## 7           0.5053612
## 8           5.2171699
## 9          50.4554779
## 10          1.5021963
## 11         15.1430588
## 12        143.0425550</code></pre>
<p>可见估计值和理论值之间非常接近.</p>
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-1-exercise-5.4" class="section level2">
<h2>Question 1: Exercise 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2,…, 0.9.
Compare the estimates with the values returned by the pbeta function in
R.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<div id="算法及代码实现" class="section level3">
<h3>1.算法及代码实现</h3>
<p><span class="math inline">\(Beta(3,3)\)</span>的密度为 <span class="math display">\[f(x)=30x^2(1-x)^2,\quad 0\le x\le 1.\]</span>
那么对应的分布函数为 <span class="math display">\[F(x)=\int_0^x
30t^2(1-t)^2\mathrm{d}t.\]</span> 当<span class="math inline">\(0\le
x\le 1\)</span>时，<span class="math inline">\(F(x)=30x\mathbb{E}[U^2(1-U)^2]\)</span>，其中<span class="math inline">\(U\sim U(0,x)\)</span>.</p>
<p>因此有如下算法：</p>
<ol style="list-style-type: decimal">
<li><p>生成<span class="math inline">\(n\)</span>个<span class="math inline">\(U(0,x)\)</span>随机数<span class="math inline">\(u_1,\cdots,u_n\)</span>.</p></li>
<li><p>输出<span class="math inline">\(\frac{30x}{n}\sum_{i=1}^n
u_i^2(1-u_i)^2\)</span>.</p></li>
</ol>
<p>代码实现如下：</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>pbetaEstimator <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>  <span class="co"># x: 目标F(x)中的x</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="co"># n: 估计所使用的随机数数目</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="co"># return: 输出估计</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>  </span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>  <span class="co"># 0.排除x小于零或者大于一的情况</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  }</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  </span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">1</span>)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  }</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  </span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>  <span class="co"># 1.生成U</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, x)</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  </span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>  <span class="co"># 2.输出估计</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">30</span><span class="sc">*</span>x<span class="sc">*</span><span class="fu">mean</span>(u<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="实验结果" class="section level3">
<h3>2.实验结果</h3>
<p>实验结果如下表：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240927</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>estimates <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>contrast <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  estimates[i] <span class="ot">&lt;-</span> <span class="fu">pbetaEstimator</span>(<span class="fl">0.1</span><span class="sc">*</span>i, n)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  contrast[i] <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="fl">0.1</span><span class="sc">*</span>i, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>}</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="at">estimate=</span>estimates, <span class="at">contrast=</span>contrast, <span class="at">error=</span>estimates<span class="sc">-</span>contrast)</span></code></pre></div>
<pre><code>##     x    estimate contrast         error
## 1 0.1 0.008845934  0.00856  0.0002859336
## 2 0.2 0.055452430  0.05792 -0.0024675698
## 3 0.3 0.161187751  0.16308 -0.0018922488
## 4 0.4 0.309245599  0.31744 -0.0081944006
## 5 0.5 0.495478724  0.50000 -0.0045212763
## 6 0.6 0.663529285  0.68256 -0.0190307155
## 7 0.7 0.825432885  0.83692 -0.0114871153
## 8 0.8 0.930976967  0.94208 -0.0111030327
## 9 0.9 0.993032522  0.99144  0.0015925218</code></pre>
<p>可见二者差异很小.</p>
</div>
</div>
<div id="question-2-exercise-5.9" class="section level2">
<h2>Question 2: Exercise 5.9</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},\quad
x\ge 0,\sigma&gt;0.\]</span></p>
<p>Implement a function to generate samples from a Rayleigh(σ)
distribution, using antithetic variables.</p>
<p>What is the percent reduction in variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{3}\)</span> for independent <span class="math inline">\(X_1\)</span>, <span class="math inline">\(X_2\)</span>?</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>使用逆变换法生成随机数. 目标分布的逆为 <span class="math display">\[F^{-1}(x)=\sqrt{-2\sigma^2\ln(1-x)}.\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>inverseF <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x)))</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>}</span></code></pre></div>
<p>接下来我考虑<span class="math inline">\(\sigma=1\)</span>时的情况，两种方法都使用2000个随机数.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># 随机数数目的一半</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>下面是不使用对偶变量生成随机数的代码实现：</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240928</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">inverseF</span>(u1, sigma)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">inverseF</span>(u2, sigma)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>variance1 <span class="ot">&lt;-</span> <span class="fu">var</span>((v1<span class="sc">+</span>v2)<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>下面是使用对偶变量生成随机数的代码实现：</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240928</span>)</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> u1</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> <span class="fu">inverseF</span>(u1, sigma)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>v2 <span class="ot">&lt;-</span> <span class="fu">inverseF</span>(u2, sigma)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>variance2 <span class="ot">&lt;-</span> <span class="fu">var</span>((v1<span class="sc">+</span>v2)<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>因此方差减少了</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>(variance1<span class="sc">-</span>variance2)<span class="sc">/</span>variance1</span></code></pre></div>
<pre><code>## [1] 0.9506483</code></pre>
</div>
<div id="question-3-exercise-5.13" class="section level2">
<h2>Question 3: Exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, +\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x) = \frac{x^2}{
\sqrt{2\pi}} e^{−x^2/2}, \quad x&gt; 1.\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}\mathrm{d}x\]</span>
by importance sampling? Explain.</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<div id="找重要性函数" class="section level3">
<h3>1.找重要性函数</h3>
<p>我们选出的重要性函数应该尽可能接近<span class="math inline">\(g(x)\)</span>，下面先看看<span class="math inline">\(g(x)\)</span>的形状.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>}</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a><span class="fu">curve</span>(g, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">6</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到<span class="math inline">\(g(x)\)</span>先增再减，其次注意到<span class="math inline">\(g(x)\)</span>并不是厚尾的， 因此可以选择<span class="math inline">\(Gamma\)</span>分布作为重要性函数.</p>
<p>从另一方面看，<span class="math inline">\(g(x)\)</span>基本是单调递减的，只有<span class="math inline">\(x\in[1,\sqrt{2}]\)</span>时<span class="math inline">\(g(x)\)</span>是单调递增的，同时<span class="math inline">\(g(x)\)</span>在零附近的密度显著地大于零，因此也可以选择指数分布作为重要性函数.</p>
<p>综上所述，我选取<span class="math display">\[f_1(x)=4(x-1)e^{-2(x-1)},\quad x&gt; 1.\]</span>
以及 <span class="math display">\[f_2(x)=e^{-(x-1)},\quad
x&gt;1.\]</span></p>
<p>二者和<span class="math inline">\(g(x)\)</span>的形状比较如下图所示：</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="dv">3</span><span class="sc">*</span><span class="fu">g</span>(x)}, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">&quot;3g&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">rate=</span><span class="dv">2</span>)}, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">&quot;f1&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">dexp</span>(x<span class="dv">-1</span>, <span class="at">rate=</span><span class="dv">1</span>)}, <span class="fu">aes</span>(<span class="at">color=</span><span class="st">&quot;f2&quot;</span>), <span class="at">linewidth =</span> <span class="fl">1.3</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>, <span class="dv">6</span>) <span class="sc">+</span> </span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;X&quot;</span>, </span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;y&quot;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>       <span class="at">title=</span><span class="st">&quot;Importance Functions VS Target&quot;</span>,</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>       <span class="at">color=</span><span class="st">&quot;Functions&quot;</span>) <span class="sc">+</span> </span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;3g&quot;</span><span class="ot">=</span><span class="st">&quot;black&quot;</span>, <span class="st">&quot;f1&quot;</span><span class="ot">=</span><span class="st">&quot;#FF410D99&quot;</span>, <span class="st">&quot;f2&quot;</span><span class="ot">=</span><span class="st">&quot;#6EE2FF99&quot;</span>)) <span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>))</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>Figure</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>图中黑色曲线是<span class="math inline">\(3g(x)\)</span>，这里乘一个倍数是为了方便比较这三个函数的形状.
可见我选取的两个重要性函数和<span class="math inline">\(g(x)\)</span>都比较’close’.</p>
</div>
<div id="比较二者的效果" class="section level3">
<h3>2.比较二者的效果</h3>
<p>先实现重要性采样法：</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>ISEstimator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, type) {</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  <span class="co"># n: 估计所使用的样本数</span></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  <span class="co"># type: 只能取1和2，表示取f1还是f2</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="co"># return: 估计值</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">rate=</span><span class="dv">2</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">dgamma</span>(x, <span class="at">shape=</span><span class="dv">2</span>, <span class="at">rate=</span><span class="dv">2</span>))</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  }</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  <span class="cf">if</span> (type <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="dv">1</span>)</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">dexp</span>(x, <span class="dv">1</span>))</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  }</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>  </span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>}</span></code></pre></div>
<p>通过分部积分，我们可以计算得 <span class="math display">\[\int_1^\infty
g(x)\mathrm{d}x=\frac{1}{\sqrt{2\pi}}e^{-1/2}+\int_1^\infty\frac{1}{\sqrt{2\pi}}e^{-x^2/2}\mathrm{d}x.\]</span>
可见右侧第二项是标准正态分布大于1的概率.</p>
<p>当<span class="math inline">\(n=1000\)</span>时估计结果如下</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240928</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">+</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="co"># 根据标准正态分布的对称性，其大于1的概率等于其小于-1的概率</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">f1=</span><span class="fu">ISEstimator</span>(n, <span class="dv">1</span>), <span class="at">f2=</span><span class="fu">ISEstimator</span>(n, <span class="dv">2</span>), <span class="at">target=</span>target)</span></code></pre></div>
<pre><code>##          f1        f2   target
## 1 0.3989961 0.4044094 0.400626</code></pre>
<p>可见两个估计值都与理论值相近.</p>
<p>下面通过蒙特卡罗方法估计两种估计的方差.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240928</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>  result1 <span class="ot">&lt;-</span> <span class="fu">c</span>(result1, <span class="fu">ISEstimator</span>(n, <span class="dv">1</span>))</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  result2 <span class="ot">&lt;-</span> <span class="fu">c</span>(result2, <span class="fu">ISEstimator</span>(n, <span class="dv">2</span>))</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>}</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>variance1 <span class="ot">&lt;-</span> <span class="fu">var</span>(result1)</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>variance2 <span class="ot">&lt;-</span> <span class="fu">var</span>(result2)</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">variance1=</span>variance1, <span class="at">variance2=</span>variance2)</span></code></pre></div>
<pre><code>##      variance1    variance2
## 1 7.857734e-05 2.557967e-05</code></pre>
<p>可见使用<span class="math inline">\(f_2\)</span>的时候方差更小.</p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>For <span class="math inline">\(n=10^4,2\times 10^4,4\times 10^4,
6\times 10^4, 8\times 10^4\)</span>, apply the fast sorting algorithm to
randomly permuted numbers of <span class="math inline">\(1,\cdots,n\)</span>.</p>
<p>Calculate computation time averaged over 100 simulations, denoted by
<span class="math inline">\(a_n\)</span>.</p>
<p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log n\)</span>, and graphically show the
results (scatter plot and regression line).</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<div id="算法以及代码实现" class="section level3">
<h3>1. 算法以及代码实现</h3>
<p>算法如下：</p>
<ol style="list-style-type: decimal">
<li>如果序列长度小于等于1则停止.</li>
<li>将序列第一个元素记为<span class="math inline">\(x\)</span>，将比<span class="math inline">\(x\)</span>小的元素移动到<span class="math inline">\(x\)</span>左侧，将比<span class="math inline">\(x\)</span>大的元素移到<span class="math inline">\(x\)</span>右侧.</li>
<li>对<span class="math inline">\(x\)</span>左右两侧两个子序列重复上述两个步骤</li>
</ol>
<p>使用递归的方法实现这个算法：</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>QuickSort <span class="ot">&lt;-</span> <span class="cf">function</span>(v) {</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>  <span class="co"># 1. 如果长度小于等于一则停止</span></span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(v) <span class="sc">&lt;=</span> <span class="dv">1</span>) {</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>    <span class="fu">return</span>(v)</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  }</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> v[<span class="dv">1</span>]</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>  </span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>  <span class="co"># 2. 分成两个新向量</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> v[v <span class="sc">&lt;</span> x]</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  v2 <span class="ot">&lt;-</span> v[v <span class="sc">&gt;</span> x]</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  </span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  <span class="co"># 3. 对v1和v2重复上述步骤</span></span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">QuickSort</span>(v1), x, <span class="fu">QuickSort</span>(v2))</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>  </span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="考察计算时间和nlogn之间的关系" class="section level3">
<h3>2. 考察计算时间和nlog(n)之间的关系</h3>
<p><span class="math inline">\(a_n\)</span>计算结果如下：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20240928</span>)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>ns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> ns) {</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>    </span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>    t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">QuickSort</span>(v)</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>    t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>    </span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>    ts <span class="ot">&lt;-</span> <span class="fu">c</span>(ts, t2<span class="sc">-</span>t1)</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>  }</span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>  an <span class="ot">&lt;-</span> <span class="fu">c</span>(an, <span class="fu">mean</span>(ts))</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>}</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">tn=</span>ns<span class="sc">*</span><span class="fu">log</span>(ns), <span class="at">an=</span>an)</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a>data </span></code></pre></div>
<pre><code>##         tn         an
## 1  92103.4 0.01543624
## 2 198069.8 0.02926806
## 3 423865.4 0.05999350
## 4 660126.0 0.08277368
## 5 903182.6 0.11241215</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># 我这里设置了seed但在不同的实验中a_n的值还是有波动，我怀疑是计算机自身造成的</span></span></code></pre></div>
<p><span class="math inline">\(a_n\)</span>和<span class="math inline">\(t_n\)</span>的散点图和回归线如下图所示：</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>Figure <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x=</span>tn, <span class="at">y=</span>an)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">color=</span><span class="st">&quot;#FF410D99&quot;</span>) <span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(t[n]), </span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>         <span class="at">y=</span><span class="fu">expression</span>(a[n]),</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>         <span class="at">title=</span><span class="st">&#39;Scatter Plot and Regression Line&#39;</span>) <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>Figure</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question-1-exercise-6.6" class="section level2">
<h2>Question 1: Exercise 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment.</p>
<p>Compute the standard error of the estimates from <span class="math display">\[\mathrm{Var}(\hat{x}_q)=\frac{q(1-q)}{nf(x_q)^2},\]</span>
using the normal approximation for the density (with exact variance
formula).</p>
<p>Compare the estimated quantiles with the quantiles of the large
sample approximation <span class="math inline">\(\sqrt{b_1}\approx
N(0,6/n)\)</span>.</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(\sqrt{b_1}\)</span>的表达式如下： <span class="math display">\[\sqrt{b_1}=\frac{\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^3}{(\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2)^{3/2}}.\]</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>Skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>  <span class="co"># x: 样本</span></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="co"># return: 样本对应的样本偏度系数</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  </span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">mean</span>((x<span class="sc">-</span><span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">var</span>(x)<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>  </span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">/</span>b)</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>}</span></code></pre></div>
<div id="估计分位数" class="section level3">
<h3>1. 估计分位数</h3>
<p>每次实验的代码实现如下：</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>MC <span class="ot">&lt;-</span> <span class="cf">function</span>(q, n, m) {</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>  <span class="co"># q: q分位数，这里q可以为向量</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="co"># n: \sqrt{b_1}中的n</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  <span class="co"># m: 重复次数</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="co"># return: 一个长度和q相同的向量，每一项为对应的q分位数</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  </span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  bs <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>    <span class="fu">Skewness</span>(x)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  })</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  </span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">quantile</span>(bs, q))</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>}</span></code></pre></div>
<p>不妨取<span class="math inline">\(n=100\)</span>，每次实验重复<span class="math inline">\(m=10000\)</span>次.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241002</span>)</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">MC</span>(qs, n, m)</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>result1</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.4604299 -0.3781228  0.3735846  0.4518387</code></pre>
</div>
<div id="计算标准差" class="section level3">
<h3>2. 计算标准差</h3>
<p>根据教材一第167页第七行，我使用如下公式计算<span class="math inline">\(\sqrt{b_1}\)</span>的方差： <span class="math display">\[\mathrm{Var}(\sqrt{b_1})=\frac{6(n-2)}{(n+1)(n+3)}.\]</span>
因此用<span class="math inline">\(N\left(0,
\frac{6(n-2)}{(n+1)(n+3)}\right)\)</span>作为<span class="math inline">\(\sqrt{b_1}\)</span>的分布的近似.
因此有如下函数计算标准差：</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>SD <span class="ot">&lt;-</span> <span class="cf">function</span>(q, n, m) {</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>  <span class="co"># q: q分位数</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="co"># n: \sqrt{b_1}中的n</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="co"># m: 估计分位数时一次MC实验中重复m次</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  <span class="co"># return: 使用正态近似\sqrt{b_1}分布后的理论标准差</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  </span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  variance <span class="ot">&lt;-</span> <span class="dv">6</span> <span class="sc">*</span> (n<span class="dv">-2</span>) <span class="sc">/</span> ((n<span class="sc">+</span><span class="dv">1</span>) <span class="sc">*</span> (n<span class="sc">+</span><span class="dv">3</span>))</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">qnorm</span>(q, <span class="dv">0</span>, <span class="fu">sqrt</span>(variance)), <span class="dv">0</span>, <span class="fu">sqrt</span>(variance))</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  <span class="fu">return</span>(q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>(m<span class="sc">*</span>f<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>}</span></code></pre></div>
<p>结果如下：</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">SD</span>(qs, n, m)</span></code></pre></div>
<pre><code>## [1] 4.033366e-05 2.524032e-05 2.524032e-05 4.033366e-05</code></pre>
</div>
<div id="比较" class="section level3">
<h3>3. 比较</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(qs, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n))</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Estimate=</span>result1, <span class="at">LargeSample=</span>result2)</span></code></pre></div>
<pre><code>##         Estimate LargeSample
## 2.5%  -0.4604299  -0.4800912
## 5%    -0.3781228  -0.4029052
## 95%    0.3735846   0.4029052
## 97.5%  0.4518387   0.4800912</code></pre>
<p>可以发现二者有一定的差异.</p>
<p>如果将方差计算方式换成 <span class="math display">\[\mathrm{Var}(\sqrt{b_1})=\frac{6(n-2)}{(n+1)(n+3)}.\]</span>
结果如下：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(qs, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">*</span>(n<span class="dv">-2</span>)<span class="sc">/</span>((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(n<span class="sc">+</span><span class="dv">3</span>))))</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Estimate=</span>result1, <span class="at">LargeSample=</span>result2, <span class="at">NewLargeSample=</span>result3)</span></code></pre></div>
<pre><code>##         Estimate LargeSample NewLargeSample
## 2.5%  -0.4604299  -0.4800912     -0.4659695
## 5%    -0.3781228  -0.4029052     -0.3910539
## 95%    0.3735846   0.4029052      0.3910539
## 97.5%  0.4518387   0.4800912      0.4659695</code></pre>
<p>可以发现更改方差后，估计值和大样本近似值更加接近，但接近程度还是不理想.</p>
</div>
</div>
<div id="question-2-exercise-6.b" class="section level2">
<h2>Question 2: Exercise 6.B</h2>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span>, are implemented
in <span class="math inline">\(\mathsf{cor.test}\)</span>.</p>
<p>Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal.</p>
<p>Find an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>在相关性检验中，原假设为<span class="math inline">\(H_0:X\)</span>和<span class="math inline">\(Y\)</span>不相关，对立假设为<span class="math inline">\(H_a:X\)</span>和<span class="math inline">\(Y\)</span>相关.</p>
<div id="比较power" class="section level3">
<h3>1. 比较Power</h3>
<p>要比较Power，首先要确定一个置信水平<span class="math inline">\(\alpha\)</span>，然后由<span class="math inline">\(P_{H_a}(p-value\le\alpha)\)</span>得到对应的Power，再进行比较.
设采样分布为二维正态<span class="math inline">\(N(0,\Sigma)\)</span>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>PowerEstimator <span class="ot">&lt;-</span> <span class="cf">function</span>(method, Sigma, alpha, n, m) {</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>  <span class="co"># method: 检验方法，只能输入&quot;Pearson&quot;、“Spearman”和&quot;Kendall&quot;</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  <span class="co"># Sigma: 二元正态的协方差矩阵</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  <span class="co"># alpha: 置信水平</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  <span class="co"># n: 一次检验所使用的样本数</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="co"># m: 一次MC实验中重复的次数</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>  <span class="co"># return: 对应方法的Power的估计值</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>  </span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>    <span class="co"># 1. 生成n个样本</span></span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), Sigma)</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>    x <span class="ot">&lt;-</span> samples[, <span class="dv">1</span>]</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> samples[, <span class="dv">2</span>]</span>
<span id="cb66-14"><a href="#cb66-14" tabindex="-1"></a>    </span>
<span id="cb66-15"><a href="#cb66-15" tabindex="-1"></a>    <span class="co"># 2. 进行检验</span></span>
<span id="cb66-16"><a href="#cb66-16" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method=</span>method)</span>
<span id="cb66-17"><a href="#cb66-17" tabindex="-1"></a>    </span>
<span id="cb66-18"><a href="#cb66-18" tabindex="-1"></a>    <span class="co"># 3. 是否拒绝</span></span>
<span id="cb66-19"><a href="#cb66-19" tabindex="-1"></a>    result<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha</span>
<span id="cb66-20"><a href="#cb66-20" tabindex="-1"></a>  })</span>
<span id="cb66-21"><a href="#cb66-21" tabindex="-1"></a>  </span>
<span id="cb66-22"><a href="#cb66-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(tmp))</span>
<span id="cb66-23"><a href="#cb66-23" tabindex="-1"></a>}</span></code></pre></div>
<p>为了简单起见，我考虑形如<span class="math inline">\(\begin{bmatrix}1
&amp; \sigma \\ \sigma &amp; 1\end{bmatrix}\)</span>的<span class="math inline">\(\Sigma\)</span>. 取<span class="math inline">\(n=100,m=1000,\alpha=0.01\)</span>，<span class="math inline">\(\sigma\)</span>取<span class="math inline">\(0.2,
0.3, 0.4, 0.5\)</span>时实验结果如下：</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241002</span>)</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigmas) {</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>}</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>PPowers <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sigmas, <span class="cf">function</span>(x) <span class="fu">PowerEstimator</span>(<span class="st">&quot;pearson&quot;</span>, <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,x,x,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>), alpha, n, m))</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>SPowers <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sigmas, <span class="cf">function</span>(x) <span class="fu">PowerEstimator</span>(<span class="st">&quot;spearman&quot;</span>, <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,x,x,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>), alpha, n, m))</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>KPowers <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sigmas, <span class="cf">function</span>(x) <span class="fu">PowerEstimator</span>(<span class="st">&quot;kendall&quot;</span>, <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,x,x,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>), alpha, n, m))</span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">sigma=</span>sigmas, <span class="at">Pearson=</span>PPowers, <span class="at">Spearman=</span>SPowers, <span class="at">Kendall=</span>KPowers)</span></code></pre></div>
<pre><code>##   sigma Pearson Spearman Kendall
## 1   0.2   0.269    0.234   0.251
## 2   0.3   0.668    0.588   0.636
## 3   0.4   0.943    0.907   0.909
## 4   0.5   0.999    0.997   0.996</code></pre>
<p>可以看到在不同的<span class="math inline">\(\sigma\)</span>取值下，基于Pearson相关系数的检验始终更有效.</p>
</div>
<div id="找例子" class="section level3">
<h3>2. 找例子</h3>
<p>我们知道Pearson相关系数只能衡量线性相关关系，不容易捕获到非线性关系，因此只需给<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>一个强烈的非线性关系即可，
比如直接取<span class="math inline">\(E(Y|X)=I(X&gt;0)\)</span>.</p>
<p>下面我考虑这样的一个二元分布：<span class="math inline">\(X\sim
N(0,1)\)</span>，<span class="math inline">\(Y|X\sim
N(I(X&gt;0),1)\)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>PowerEstimator <span class="ot">&lt;-</span> <span class="cf">function</span>(method, alpha, n, m) {</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>  <span class="co"># method: 检验方法，只能输入&quot;Pearson&quot;、“Spearman”和&quot;Kendall&quot;</span></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  <span class="co"># alpha: 置信水平</span></span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  <span class="co"># n: 一次检验所使用的样本数</span></span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="co"># m: 一次MC实验中重复的次数</span></span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  <span class="co"># return: 对应方法的Power的估计值</span></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  </span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>    <span class="co"># 1. 生成n个样本</span></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>    </span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>    <span class="co"># 2. 进行检验</span></span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method=</span>method)</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>    </span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>    <span class="co"># 3. 是否拒绝</span></span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a>    result<span class="sc">$</span>p.value <span class="sc">&lt;=</span> alpha</span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>  })</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>  </span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(tmp))</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a>}</span></code></pre></div>
<p>取<span class="math inline">\(\alpha=0.01,n=100,m=1000\)</span>，实验结果如下：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241002</span>)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>PPower <span class="ot">&lt;-</span> <span class="fu">PowerEstimator</span>(<span class="st">&quot;pearson&quot;</span>, alpha, n, m)</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>SPower <span class="ot">&lt;-</span> <span class="fu">PowerEstimator</span>(<span class="st">&quot;spearman&quot;</span>, alpha, n, m)</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>KPower <span class="ot">&lt;-</span> <span class="fu">PowerEstimator</span>(<span class="st">&quot;kendall&quot;</span>, alpha, n, m)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">Pearson=</span>PPower, <span class="at">Spearman=</span>SPower, <span class="at">Kendall=</span>KPower)</span></code></pre></div>
<pre><code>##   Pearson Spearman Kendall
## 1    0.87     0.92    0.93</code></pre>
<p>可见此时两种非参方法效果都更好.</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<p>What is the corresponding hypothesis test problem?</p>
<p>What test should we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</p>
<p>Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<div id="原假设与对立假设" class="section level3">
<h3>1. 原假设与对立假设</h3>
<p>设这两种方法所应对的假设检验的原假设为<span class="math inline">\(H_0\)</span>，对立假设为<span class="math inline">\(H_a\)</span>. 将两种方法记为<span class="math inline">\(M_1\)</span>和<span class="math inline">\(M_2\)</span>. 记<span class="math inline">\(\beta_i=P(reject\ H_0\ using\ M_i|H_a),\
i=1,2\)</span>.</p>
<p>因此Question 3 对应的假设检验为：<span class="math inline">\(H&#39;_0:\beta_1=\beta_2\leftrightarrow
H&#39;_a:\beta_1\ne\beta_2\)</span>.</p>
</div>
<div id="检验的方法" class="section level3">
<h3>2. 检验的方法</h3>
<p>记<span class="math inline">\(I_{ki}\)</span>为“在<span class="math inline">\(H_a\)</span>成立的条件下第<span class="math inline">\(k\)</span>次实验中使用<span class="math inline">\(M_i\)</span>拒绝<span class="math inline">\(H_0\)</span>”的示性函数，那么<span class="math inline">\(I_{ki}\sim B(1,\beta_i)\)</span>.
从题意看，应该是每次实验生成样本后，基于这些生成的样本分别使用两种方法进行假设检验，因此<span class="math inline">\(I_{k1}\)</span>和<span class="math inline">\(I_{k2}\)</span>是相关的，而<span class="math inline">\(\{(I_{k1},I_{k2})\}_{k=1}^m\)</span>是独立的.
记<span class="math inline">\(p_i=\frac{1}{m}\sum_{k=1}^m I_{ki},\
i=1,2\)</span>，可见<span class="math inline">\(p_i\)</span>即为<span class="math inline">\(M_i\)</span>的Power的估计值.</p>
<p>从题目给的信息来看，我确切能知晓的数据只有<span class="math inline">\(p_i\)</span>，而不知晓<span class="math inline">\(I_{ki}\)</span>的具体取值.
在这种情况下，我认为这四种方法都是行不通的.</p>
<div id="z-test" class="section level4">
<h4>(1). Z-test</h4>
<p>由于<span class="math inline">\(\beta_1-\beta_2=E(I_{k1}-I_{k2})\)</span>，因此实际上是要检验<span class="math inline">\(I_{k1}-I_{k2}\)</span>的总体均值是否为零.
而且在<span class="math inline">\(H&#39;_0\)</span>成立时，我们很容易得到CLT： <span class="math display">\[\frac{\sqrt{m}(p_1-p_2)}{\sqrt{\mathrm{Var}(I_{11}-I_{12})}}=\frac{\sqrt{m}\left(\frac{1}{m}\sum_{k=1}^m(I_{k1}-I_{k2})\right)}{\sqrt{\mathrm{Var}(I_{11}-I_{12})}}\to
N(0,1)\quad m\to\infty.\]</span>
那么如果要进行Z-test，现在只需要找到一个办法估计<span class="math inline">\(\mathrm{Var}(I_{11}-I_{12})\)</span>.
如果我们知道所有<span class="math inline">\(I_{ki}\)</span>的取值，那么直接使用<span class="math inline">\(\{I_{k1}-I_{k2}\}\)</span>的样本二阶矩来估计就行了(在<span class="math inline">\(H&#39;_0\)</span>成立时<span class="math inline">\(I_{k1}-I_{k2}\)</span>的总体方差等于总体二阶矩).
但是如果我们不知道<span class="math inline">\(I_{ki}\)</span>，只有<span class="math inline">\(p_1\)</span>和<span class="math inline">\(p_2\)</span>，我们就估计不了这个方差，因为我们处理不了<span class="math inline">\(\mathrm{Cov}(I_{11},I_{12})\)</span>.</p>
<p>如果我们知道所有<span class="math inline">\(I_{ki}\)</span>的取值，使用 <span class="math display">\[\frac{\sqrt{m}(p_1-p_2)}{\sqrt{\frac{1}{m}\sum_{k=1}^m(I_{k1}-I_{k2})^2}}=\frac{\sqrt{m}(p_1-p_2)}{\sqrt{p_1+p_2-\frac{2}{m}\sum_{k=1}^mI_{k1}I_{k2}}}\to
N(0,1).\]</span> 即可进行Z-test.</p>
</div>
<div id="two-sample-t-test-and-paired-t-test" class="section level4">
<h4>(2). two-sample t-test and paired-t test</h4>
<p>这都不是正态总体，显然不能使用t-test.</p>
<p>就算是考虑大样本情形，由于<span class="math inline">\(I_{k1}\)</span>和<span class="math inline">\(I_{k2}\)</span>不独立，显然two-sample
t-test也是不能用的. 而对于paired-t
test，它的情况和前面的Z-test是类似的，如果只知道<span class="math inline">\(p_1\)</span>和<span class="math inline">\(p_2\)</span>是无法得到<span class="math inline">\(\{I_{k1}-I_{k2}\}\)</span>的样本标准差的.</p>
</div>
<div id="mcnemar-test" class="section level4">
<h4>(3). McNemar test</h4>
<p>“<span class="math inline">\(M_1\)</span>接受<span class="math inline">\(H_0\)</span>而<span class="math inline">\(M_2\)</span>拒绝<span class="math inline">\(H_0\)</span>”的频数为<span class="math inline">\(\sum_{k=1}^mI_{k2}(1-I_{k1})\)</span>，“<span class="math inline">\(M_1\)</span>拒绝<span class="math inline">\(H_0\)</span>而<span class="math inline">\(M_2\)</span>接受<span class="math inline">\(H_0\)</span>”的频数为<span class="math inline">\(\sum_{k=1}^mI_{k1}(1-I_{k2})\)</span>.
因此对应的McNemar检验统计量为 <span class="math display">\[\chi^2=\frac{m^2(p_1-p_2)^2}{mp_1+mp_2-2\sum_{k=1}^mI_{k1}I_{k2}}.\]</span></p>
<p>可以看到，如果我们只有<span class="math inline">\(p_1\)</span>和<span class="math inline">\(p_2\)</span>，我们也是无法得到<span class="math inline">\(\chi^2\)</span>.
另外我们可以注意到这个统计量实际上是我在前面给出的Z-test统计量的平方.</p>
</div>
</div>
<div id="检验所需信息" class="section level3">
<h3>3. 检验所需信息</h3>
<p>从上述讨论可以发现，已知<span class="math inline">\(p_1\)</span>和<span class="math inline">\(p_2\)</span>的情况下，要进行假设检验，还需要知道<span class="math inline">\(\sum_{k=1}^mI_{k1}I_{k2}\)</span>即“<span class="math inline">\(M_1\)</span>和<span class="math inline">\(M_2\)</span>都拒绝<span class="math inline">\(H_0\)</span>”的频数.</p>
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-1" class="section level2">
<h2>Question 1:</h2>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, 950 are
null and 50 are alternative. The p-value under any null hypothesis is
uniformly distributed (use runif), and the p-value under any alternative
hypothesis follows the beta distribution with parameter 0.1 and 1 (use
rbeta).</p>
<p>Obtain Bonferroni adjusted p-values and B-H adjusted p-values.</p>
<p>Calculate FWER, FDR, and TPR under nominal level <span class="math inline">\(\alpha\)</span> = 0.1 for each of the two
adjustment methods based on <span class="math inline">\(m =
10000\)</span> simulation replicates.</p>
<p>You should output the 6 numbers (3 ) to a 3 × 2 table (column names:
Bonferroni correction, B-H correction; row names: FWER, FDR, TPR).</p>
<p>Comment the results.</p>
</div>
<div id="answer-1-4" class="section level2">
<h2>Answer 1:</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="dv">950</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241016</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(N0), <span class="fu">rbeta</span>(N<span class="sc">-</span>N0, <span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>  ps.Bon <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(ps, <span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  ps.BH <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(ps, <span class="at">method=</span><span class="st">&quot;fdr&quot;</span>)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>  </span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>  V.Bon <span class="ot">&lt;-</span> <span class="fu">sum</span>(ps.Bon[<span class="dv">1</span><span class="sc">:</span>N0]<span class="sc">&lt;</span>alpha)</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>  S.Bon <span class="ot">&lt;-</span> <span class="fu">sum</span>(ps.Bon[(N0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]<span class="sc">&lt;</span>alpha)</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>  R.Bon <span class="ot">&lt;-</span> V.Bon <span class="sc">+</span> S.Bon</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a>  </span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a>  V.BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(ps.BH[<span class="dv">1</span><span class="sc">:</span>N0]<span class="sc">&lt;</span>alpha)</span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>  S.BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(ps.BH[(N0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]<span class="sc">&lt;</span>alpha)</span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a>  R.BH <span class="ot">&lt;-</span> V.BH <span class="sc">+</span> S.BH</span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>  </span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a>  FWER.Bon <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(V.Bon<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a>  FDR.Bon <span class="ot">&lt;-</span> V.Bon <span class="sc">/</span> R.Bon</span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a>  TPR.Bon <span class="ot">&lt;-</span> S.Bon <span class="sc">/</span> (N <span class="sc">-</span> N0)</span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a>  </span>
<span id="cb73-20"><a href="#cb73-20" tabindex="-1"></a>  FWER.BH <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(V.BH<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb73-21"><a href="#cb73-21" tabindex="-1"></a>  FDR.BH <span class="ot">&lt;-</span> V.BH <span class="sc">/</span> R.BH</span>
<span id="cb73-22"><a href="#cb73-22" tabindex="-1"></a>  TPR.BH <span class="ot">&lt;-</span> S.BH <span class="sc">/</span> (N <span class="sc">-</span> N0)</span>
<span id="cb73-23"><a href="#cb73-23" tabindex="-1"></a>  </span>
<span id="cb73-24"><a href="#cb73-24" tabindex="-1"></a>  <span class="fu">c</span>(FWER.Bon, FDR.Bon, TPR.Bon, FWER.BH, FDR.BH, TPR.BH)</span>
<span id="cb73-25"><a href="#cb73-25" tabindex="-1"></a>})</span>
<span id="cb73-26"><a href="#cb73-26" tabindex="-1"></a></span>
<span id="cb73-27"><a href="#cb73-27" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(result1)</span>
<span id="cb73-28"><a href="#cb73-28" tabindex="-1"></a>result3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Bonferroni=</span>result2[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">BH=</span>result2[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb73-29"><a href="#cb73-29" tabindex="-1"></a><span class="fu">rownames</span>(result3) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb73-30"><a href="#cb73-30" tabindex="-1"></a>result3</span></code></pre></div>
<pre><code>##      Bonferroni         BH
## FWER 0.09380000 0.93260000
## FDR  0.00486222 0.09591136
## TPR  0.39765800 0.56193000</code></pre>
<p>使用Bonferroni修正时，<span class="math inline">\(\mathrm{FWER}=0.0938&lt;
0.1=\alpha\)</span>，这印证了Bonferroni修正能控制FWER，使之小于<span class="math inline">\(\alpha\)</span>. 使用B-H修正时，<span class="math inline">\(\mathrm{FDR}=0.09591136&lt;0.1=\alpha\)</span>，这也印证了B-H修正能将FDR控制在<span class="math inline">\(\alpha\)</span>以下.
使用Bonferroni修正时，各项指标都比使用B-H修正时低，这说明了Bonferroni修正的保守。</p>
</div>
<div id="question-2-exercise-7.4" class="section level2">
<h2>Question 2: Exercise 7.4</h2>
<p>Refer to the air-conditioning data set <span class="math inline">\(\textsf{aircondit}\)</span> provided in the <span class="math inline">\(\textsf{boot}\)</span> package. The 12
observations are the times in hours between failures of airconditioning
equipment: <span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98,
100, 130, 230, 487.\]</span> Assume that the times between failures
follow an exponential model <span class="math inline">\(\mathrm{Exp}(\lambda)\)</span>.</p>
<p>Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the
bias and standard error of the estimate.</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2:</h2>
<p>记第<span class="math inline">\(i\)</span>个观测量为<span class="math inline">\(X_i\)</span>，<span class="math inline">\(X_i\sim
\mathrm{Exp}(\lambda)\)</span>. 则对数似然函数为 <span class="math display">\[l=\sum_{i=1}^n(\ln\lambda-\lambda X_i).\]</span>
则<span class="math inline">\(\lambda\)</span>的MLE为<span class="math inline">\(\hat{\lambda}=1/\bar{X}\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(aircondit<span class="sc">$</span>hours)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>lambda.hat</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
<p>使用bootstrap估计此估计量的偏差和标准差的结果如下</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241016</span>)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x[i])</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>boot<span class="sc">::</span>aircondit<span class="sc">$</span>hours, <span class="at">statistic=</span>MLE, <span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>result<span class="sc">$</span>t0, <span class="at">bias=</span><span class="fu">mean</span>(result<span class="sc">$</span>t)<span class="sc">-</span>result<span class="sc">$</span>t0, <span class="at">se=</span><span class="fu">sd</span>(result<span class="sc">$</span>t)), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## original     bias       se 
##    0.009    0.001    0.004</code></pre>
</div>
<div id="question-3-exercise-7.5" class="section level2">
<h2>Question 3: Exercise 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3:</h2>
<p>使用<span class="math inline">\(\bar{X}\)</span>估计<span class="math inline">\(1/\lambda\)</span>.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241016</span>)</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>boot.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">mean</span>(x[i])</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>boot.obj <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot</span>(<span class="at">data=</span>boot<span class="sc">::</span>aircondit<span class="sc">$</span>hours, <span class="at">statistic=</span>boot.mean, <span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>CI <span class="ot">&lt;-</span> boot<span class="sc">::</span><span class="fu">boot.ci</span>(boot.obj, <span class="at">conf=</span><span class="fl">0.95</span>, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>CI</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot::boot.ci(boot.out = boot.obj, conf = 0.95, type = c(&quot;norm&quot;, 
##     &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.1, 182.0 )   ( 25.0, 169.2 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.9, 191.2 )   ( 56.7, 225.9 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>得到的置信区间为:</p>
<p>(1). Standard normal: (35.1, 182.0)</p>
<p>(2). Basic: (25.0, 169.2)</p>
<p>(3). Percentile: (46.9, 191.2)</p>
<p>(4). BCa: (56.7, 225.9)</p>
<p>不同的方法原理不同，并且BCa方法是二阶精度，其他三种方法只有一阶精度，所以这些区间有所不同.</p>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question-1-exercise-7.8" class="section level2">
<h2>Question 1: Exercise 7.8</h2>
<p>The five-dimensional scores data have a <span class="math inline">\(5\times5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. In
principal components analysis, <span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\]</span>
measures the proportion of variance explained by the first principal
component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\cdots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
which is the MLE of <span class="math inline">\(\Sigma\)</span>. The
sample estimate of <span class="math inline">\(\theta\)</span> is <span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}.\]</span>
Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1:</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span>scor</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>Sigma.hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>lambdas.hat <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma.hat)<span class="sc">$</span>values</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambdas.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambdas.hat)</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>thetas.jack <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data)[<span class="dv">1</span>]) {</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[<span class="sc">-</span>i, ]</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>  Sigma.jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(x)</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  lambdas.jack <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma.jack)<span class="sc">$</span>values</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  theta.jack <span class="ot">&lt;-</span> lambdas.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambdas.jack)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>  thetas.jack <span class="ot">&lt;-</span> <span class="fu">c</span>(thetas.jack, theta.jack)</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>}</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a></span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (<span class="fu">dim</span>(data)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(thetas.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">dim</span>(data)[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">mean</span>((thetas.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat, <span class="at">bias.jack=</span>bias.jack, <span class="at">se.jack=</span>se.jack), <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="question-2-exercise-7.10" class="section level2">
<h2>Question 2: Exercise 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model.</p>
<p>Repeat the analysis replacing the Log-Log model with a cubic
polynomial model.</p>
<p>Which of the four models is selected by the cross validation
procedure?</p>
<p>Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2:</h2>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>ironslag</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical, data)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>), data)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical, data)</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>), data)</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(data<span class="sc">$</span>magnetic)</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data<span class="sc">$</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data<span class="sc">$</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>  </span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k]</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> data<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>  </span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k] <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> data<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>  </span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k]</span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> data<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a>  </span>
<span id="cb83-27"><a href="#cb83-27" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb83-28"><a href="#cb83-28" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> data<span class="sc">$</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb83-29"><a href="#cb83-29" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> data<span class="sc">$</span>magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb83-30"><a href="#cb83-30" tabindex="-1"></a>}</span>
<span id="cb83-31"><a href="#cb83-31" tabindex="-1"></a></span>
<span id="cb83-32"><a href="#cb83-32" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>通过交叉检验，应该选择二次模型.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">summary</span>(L1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.7180 -2.4653 -0.0549  2.0401 11.7032 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.4026     2.5843   0.543     0.59    
## chemical      0.9158     0.1190   7.695 4.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.327 on 51 degrees of freedom
## Multiple R-squared:  0.5372, Adjusted R-squared:  0.5282 
## F-statistic: 59.21 on 1 and 51 DF,  p-value: 4.375e-10</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">summary</span>(L2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2), data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4335 -2.7006 -0.2754  2.5446 12.2665 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   24.49262    9.14657   2.678   0.0100 **
## chemical      -1.39334    0.88852  -1.568   0.1232   
## I(chemical^2)  0.05452    0.02081   2.620   0.0116 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.098 on 50 degrees of freedom
## Multiple R-squared:  0.5931, Adjusted R-squared:  0.5768 
## F-statistic: 36.44 on 2 and 50 DF,  p-value: 1.728e-10</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">summary</span>(L3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(magnetic) ~ chemical, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.64173 -0.09555 -0.00529  0.10021  0.43117 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.112158   0.117442  17.985  &lt; 2e-16 ***
## chemical    0.041608   0.005409   7.693  4.4e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1967 on 51 degrees of freedom
## Multiple R-squared:  0.5371, Adjusted R-squared:  0.5281 
## F-statistic: 59.18 on 1 and 51 DF,  p-value: 4.399e-10</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">summary</span>(L4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2) + I(chemical^3), 
##     data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.5989 -2.3477 -0.3071  2.4011 12.6523 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)    3.015851  27.719225   0.109    0.914
## chemical       1.918082   4.130269   0.464    0.644
## I(chemical^2) -0.107963   0.198982  -0.543    0.590
## I(chemical^3)  0.002551   0.003107   0.821    0.416
## 
## Residual standard error: 4.112 on 49 degrees of freedom
## Multiple R-squared:  0.5986, Adjusted R-squared:  0.574 
## F-statistic: 24.36 on 3 and 49 DF,  p-value: 8.611e-10</code></pre>
<p>四种模型的adjusted <span class="math inline">\(R^2\)</span>分别为0.5282、0.5768、0.5281，0.574.
可见二次模型的adjusted <span class="math inline">\(R^2\)</span>最大.</p>
</div>
<div id="question-3-exercise-8.1" class="section level2">
<h2>Question 3: Exercise 8.1</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3:</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed<span class="sc">==</span><span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed<span class="sc">==</span><span class="st">&quot;linseed&quot;</span>]))</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>CMtest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>  </span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>  </span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>  W <span class="ot">&lt;-</span> m<span class="sc">*</span>n <span class="sc">/</span> (m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((<span class="fu">Fn</span>(z)<span class="sc">-</span><span class="fu">Gm</span>(z))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>  </span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241025</span>)</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>W0 <span class="ot">&lt;-</span> <span class="fu">CMtest</span>(x, y)</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">+</span>m), <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>  W[i] <span class="ot">&lt;-</span> <span class="fu">CMtest</span>(x1, y1)</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>}</span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(W0, W) <span class="sc">&gt;=</span> W0)</span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.426</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="fu">hist</span>(W, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">freq=</span><span class="cn">FALSE</span>, <span class="at">breaks =</span> <span class="st">&quot;scott&quot;</span>)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">points</span>(W0, <span class="dv">0</span>, <span class="at">cex=</span><span class="dv">1</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>ASL为0.426，不足以拒绝原假设.</p>
</div>
<div id="question-4-exercise-8.2" class="section level2">
<h2>Question 4: Exercise 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence as a permutation test. The Spearman rank correlation test
statistic can be obtained from function <span class="math inline">\(\mathsf{cor}\)</span> with <span class="math inline">\(\mathsf{method =
&quot;spearman&quot;}\)</span>.</p>
<p>Compare the achieved significance level of the permutation test with
the p-value reported by <span class="math inline">\(\mathsf{cor.test}\)</span> on the same
samples.</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4:</h2>
<p>实验所用样本来自<span class="math inline">\((X,Y)\sim
N(0,\Sigma)\)</span>，其中<span class="math inline">\(\Sigma=\begin{bmatrix} 1 &amp; \sigma \\ \sigma
&amp; 1 \end{bmatrix}\)</span>.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>SampleGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(n, sigma) {</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>  <span class="co"># n: 生成的样本数</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>  <span class="co"># sigma: 正态分布的参数</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  <span class="co"># return: x和y</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  </span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, sigma, sigma, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), Sigma)</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>SpearmanTest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, R) {</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>  <span class="co"># x, y: 数据</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="co"># R: permutation重复次数</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  <span class="co"># return: 近似ASL和p值</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  </span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>  test0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>  tests <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>    <span class="fu">cor</span>(x1, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>  })</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a>  ASL <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(<span class="fu">abs</span>(tests), <span class="fu">abs</span>(test0)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(test0))</span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>  </span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">ASL=</span>ASL, <span class="at">p.value=</span>p))</span>
<span id="cb99-15"><a href="#cb99-15" tabindex="-1"></a>}</span></code></pre></div>
<p>取样本数目<span class="math inline">\(n=25\)</span>，重复次数<span class="math inline">\(R=999\)</span>，对<span class="math inline">\(\sigma=0.1,0.3,0.5\)</span>时的情况进行了实验.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241027</span>)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>)</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>ASLs <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigmas) {</span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">SampleGenerator</span>(n, sigma)</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> samples[, <span class="dv">1</span>]</span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a>  y <span class="ot">&lt;-</span> samples[, <span class="dv">2</span>]</span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">SpearmanTest</span>(x, y, R)</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>  ASLs <span class="ot">&lt;-</span> <span class="fu">c</span>(ASLs, result[<span class="dv">1</span>])</span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a>  p.values <span class="ot">&lt;-</span> <span class="fu">c</span>(p.values, result[<span class="dv">2</span>])</span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a>}</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">sigma=</span>sigmas, <span class="at">ASL=</span>ASLs, <span class="at">p.value=</span>p.values)</span></code></pre></div>
<pre><code>##   sigma   ASL    p.value
## 1   0.1 0.744 0.74455227
## 2   0.3 0.089 0.07713312
## 3   0.5 0.029 0.03438329</code></pre>
<p>可见ASL和p值相近.</p>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question-1-exercies-9.3" class="section level2">
<h2>Question 1: Exercies 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution.</p>
<p>Discard the first 1000 of the chain, and compare the deciles of the
generated observations with the deciles of the standard Cauchy
distribution (see qcauchy or qt with df=1).</p>
<p>Recall that a <span class="math inline">\(\mathrm{Cauchy}(\theta,
\eta)\)</span> distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\quad
-\infty&lt;x&lt;\infty,\ \theta&gt;0.\]</span> The standard Cauchy has
the <span class="math inline">\(\mathrm{Cauchy}(\theta = 1, \eta =
0)\)</span> density. (Note that the standard Cauchy density is equal to
the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1:</h2>
<p>使用随机游走Metropolis算法，取提议分布为<span class="math inline">\(N(X_t,\sigma^2)\)</span>，则接受概率为<span class="math inline">\(f(Y)/f(X_t)=\frac{\theta^2+(X_t-\eta)^2}{\theta^2+(Y-\eta)^2}\)</span>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>CauchyGenerator <span class="ot">&lt;-</span> <span class="cf">function</span>(N, theta, eta, x0, sigma) {</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>  <span class="co"># n: 生成的样本数</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>  <span class="co"># theta, eta: Cauchy分布的参数</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>  <span class="co"># x0: 初始值</span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>  <span class="co"># sigma: 提议分布的参数</span></span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  <span class="co"># return: 长度为n的向量</span></span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>  </span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N) <span class="co"># 用于和接受概率比较</span></span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">dcauchy</span>(y, eta, theta)<span class="sc">/</span><span class="fu">dcauchy</span>(x[i<span class="dv">-1</span>], eta, theta)) {</span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a>    }</span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb102-18"><a href="#cb102-18" tabindex="-1"></a>    }</span>
<span id="cb102-19"><a href="#cb102-19" tabindex="-1"></a>  }</span>
<span id="cb102-20"><a href="#cb102-20" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb102-21"><a href="#cb102-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241031</span>)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">CauchyGenerator</span>(N, theta, eta, x0, sigma)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>收敛情况不错.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">hist</span>(x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">5000</span>], <span class="at">breaks=</span><span class="st">&quot;scott&quot;</span>, <span class="at">proba=</span><span class="cn">TRUE</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="fu">curve</span>(dcauchy, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///T09PbkDrb2//b/9vb////AAD/tmb/25D//7b//9v///8hZMbdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHP0lEQVR4nO2d2ZabOBRFlXIl6XI6Dl2mu8A2//+bjRhseUBHgIYLnP2QOMusK3lHaBaoilhRqTMgHQoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEGCcoMtBNbx9BsqOPEYJytVH+6HsP6yfMYIuh6uWfPcVIDMSGSPovP/dfyw3c5OxBAFG1kFdEWIdNMB537Zimyk/7AdBKAgwQVCp1Lc//nMilHGCMqU+Tn99mQ1+RIoEaY4TlNWVc9aUniTNvHhBTbk5/dCCUnQUiwUI0r2fy79VmhIkX1CV9+WmVWVEueItY88sQFCVt81XqYbq6K0Lih3OpJBfSccPZ7IsQflAK0ZBccOZUBCAgqxxlSpUEkOeVzWCCToelyAIr2psW5DDnPS2BTmsamxbUNISVBzlC3JY1di4ILyqsXVBscPd4lIQiEtBIK4WVHem469S+Ukx+IxiI6gpRbFZUgmiIEtcCgJxKQjEpSAQl4JAXAoCcRtBekQfm2uK9TDr3WM4z6jimFqQHqur2VsPVy2o8uBo7YJaRTO2tqxcUFnb+V1dDtP3tqxZkJ4Ma83M2B21YkHnvY+dmWsW9Kv1M29z3QYEDe3bGBnOM8kFZbcprynNfPgJs9SCbiXIUzjPCBAkMtwt7iIEtXtbyyS7OxILqn96vyZo6Uc3gppF58GjCIEFHeMv/IwtQZ2a6GvzixF0+t4Iir67Q4Ag/fNz62HCjZegbPd1+v5eZcPTZm019V49H0V4Ec4vAgTpoqGPGNiHGrWjesg2fKZ35YKyWo7MoUbtJ7Wg+t4673df5/2smek1C2runsth3sz9mgVJDHdlGYKune3h/vaaBTk8G+hyQDX4mgVlDs0XrKJWLGiw73fHwGHM4BNmIgT5eFbAigXNbeAfwnlGgCDLUeZJ4fwiQJDDhJlB7DOrvSAV3dDCOooUNIAIQfVNtvvK5u0QWrOg8tufXI/mbYaSnVkVIEifltMTqbb5oGRnVguVXpDuKGpBlhnFdCcOJQjqS1A2PGuf7syqBEFdHZRbuovbLkFdV9G6iyrZmVUZghxIdWZ1MYJih+sxBIV9DNgzD2Oxuc9uC5J5fRbzKugY+bxGn1rWVi/5tH3kYSfMVHG8Cop+oKVLrewr525zwsxwfhEgyJgts6zNO4fzjABBxghM4NKzCEGenlZPQU7hPENBKKgpKPZGTgpCiTd/Oqy6jwnnmeKYXJDUcC0UBKAgAAUBKAhwLyjy8jMFARYgSE8GUZCFNQgKOWFWVI+Cos66yi9BT4JU1PGqdEHNswGXIyj+5oXuFMudoKhdoVFJJdi8sChBKZaeFyUoxeaFbmPQvaCYLb30ErQoQQk2L/RLqg+CIi7RS9680DXxrwTFe3Ky5H6Quo1SnwRFMyRYUFEcBwXpN7V4TMqC2I7i7fZ6JSjeThipHcWieDby+M8ixjvrRDbz+pcrLEiXouCOpHUUC01zGzsJah2FtJS2BLU1WmEwUPFYBOm/7kI0AxFvk1N+OooPE2bFOJRnQHIBBfF98+QJCgJMFDRvo96SCF6CfNfAfhiR/3BqRiQQ+aIxv5qC/F1aOT0AZVICaxGEB6sTE1iJIIehxsQEViJo0l7YLQliCULgVY2JCaxF0JTB6rYEbRAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQECCiomcBupkVK65OtTj8/8UX2b13juGbJIJygy6HOQa7fU6IfLVMOZue8b2Yn7RfZv3WN45olk3CC2gft5G+f7UTk0FNlynaNxH6R/VvnOI5ZuiN0HVT/N12z9fJ79dHMb1svAt+6x3HK0j2hBWVvn6cfuigPT/O3P8x6EQrhGsc1SwaBBenJ6/Zet9QvOp/2i1AI1ziuWTIIK6jsK0Q5gpyyZBBUULv4IeoWc8uSQRBB3VvZu5XqgRrx+up2L5W0WxyQpVcELEH9KhpqU0svzbxTHNcsGYTsB/WLi6BXVvrpKDrEcc6SQThBebvGqHOR20cRbUm3X2T/1jGOc5YMOFgFUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBpAvSu8CMV1TGR7qg/i3vyZAuqCrf/vnltNMpEOIFVZma9WrcucgXVKpZL1eei3hBl8PfSR9JKF5QvvvvkLAREy9IP/Vq3qtfZyJdUFY38ca7zOMjXVByKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwP9/ZNrDlYVBlAAAAABJRU5ErkJggg==" /><!-- --></p>
<p>从直方图来看，生成的样本符合目标分布.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>qs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(qs)</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">5000</span>], <span class="at">probs=</span>qs)</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">q=</span>qs, <span class="at">Cauchy=</span>result1, <span class="at">Observation=</span>result2, <span class="at">Differece=</span>result2<span class="sc">-</span>result1)</span></code></pre></div>
<pre><code>##       q     Cauchy Observation   Differece
## 10% 0.1 -3.0776835 -2.70561324  0.37207029
## 20% 0.2 -1.3763819 -1.27834858  0.09803334
## 30% 0.3 -0.7265425 -0.62777972  0.09876281
## 40% 0.4 -0.3249197 -0.28454010  0.04037960
## 50% 0.5  0.0000000 -0.03855417 -0.03855417
## 60% 0.6  0.3249197  0.25947741 -0.06544229
## 70% 0.7  0.7265425  0.64996650 -0.07657603
## 80% 0.8  1.3763819  1.23411505 -0.14226687
## 90% 0.9  3.0776835  2.41739405 -0.66028949</code></pre>
<p>理论十分位数和样本十分位数相差不是很大，看起来离0越远的地方估计效果越差，这可能是因为Cauchy分布是个厚尾分布，导致随机游走过程中可能会长时间都留在远离0的部分.</p>
</div>
<div id="question-2-exercies-9.8" class="section level2">
<h2>Question 2: Exercies 9.8</h2>
<p>Consider the bivariate density <span class="math display">\[f(x,y)\propto
\binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,\dots, n,\ 0\le y\le
1.\]</span> It can be shown that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\mathrm{Binomial}(n, y)\)</span> and
<span class="math inline">\(\mathrm{Beta}(x + a, n − x +
b)\)</span>.</p>
<p>Use the Gibbs sampler to generate a chain with target joint density
<span class="math inline">\(f(x, y)\)</span>.</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2:</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>GibbsSampler <span class="ot">&lt;-</span> <span class="cf">function</span>(N, z0, a, b, n) {</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>  <span class="co"># N: 生成样本数</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>  <span class="co"># z0: 初始值，一个二维向量</span></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>  <span class="co"># a, b, n: 目标分布的参数</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>  <span class="co"># return: Nx2的矩阵</span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>  </span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>N, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>  z[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> z0</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> z0[<span class="dv">1</span>]</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> z0[<span class="dv">2</span>]</span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>    z[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>  }</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>}  </span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241101</span>)</span>
<span id="cb109-2"><a href="#cb109-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb109-3"><a href="#cb109-3" tabindex="-1"></a>z0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb109-4"><a href="#cb109-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb109-5"><a href="#cb109-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb109-6"><a href="#cb109-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb109-7"><a href="#cb109-7" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">GibbsSampler</span>(N, z0, a, b, n)</span></code></pre></div>
<p>生成效果如下：</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">plot</span>(z[,<span class="dv">1</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">11</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">plot</span>(z[,<span class="dv">2</span>], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAVFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtrZmtv+QOgCQkGaQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v////lmPg8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIJUlEQVR4nO3dCXubRhSF4eslrdXWrhWrwfL9//+zbLMxM5wBgTRWzve0WQyD4A0gyUFElM0mt16B2iMQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiECgZUBfb9L3+LHT6tTXIqCTvAy/aMwv7r8lQF9vluX09GuHlamxJUDnw6v5ZfPbHGTcg0ALz0HjLsRzUKbzYXgWy+4/8m3aB+jai9svAoH2BjplnsUIlFnK4kP71vEQAxEItBPQqT2I+pdCPAclOz28ty+FnpVA6Ya3Gl9v7ctEAqUyb1aPT78IlMq+WT0+EyiZYWnfkhEomXk7//VGoJ0f99YRCEQgEIFABAIRCEQgEIFA/I4iiHsQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBCIQiEAgAoEIBKrgG2bhkiX5WGJGZ6dlHxHPomZtJDFnBXtQuNFi19L7uoRA7uvhD5pgF298bl2qBhK7fuOmiNkebzebBxJNDfFHLgCa7qO3B5IMkHjrvQoo/fXUuhgVSRzEtQAJBhKLOQfkDq1yIA2BJJy4dIu2KQkkKSCJgCQHJBMgMae0CCj4vQOS+oBkCqRmqyzQuM4SA0kGyHKa5ftu3kgd57s60PnQXYLXyMxnVn0gRUBmvSGQekCSBkqeq/yHuhpQ/1E677OH6cX5QBIBuS3NAHk7j9qDUFYBmcHXAhppcp84nAAJBJI0kCSB7MY6IHtshU8AMZBcCejzRw+U+8zqGiDvYPMGB0DeARkNM0M0BWT+0+nz/Hfag7YCkgqAujV4VnO6nlnclkAyAVJ/iIQP58RuAaS90cP7zGd6twCSAiA3PHw4BOTtYUuB2k1/LnaCi5sD0gjIbLcZa03MmTYGUgyk9vS+CdDwWadLP+0d7AQTINEAyO0I7g95HOsDiVwAZA/XTYB0gRH4rIaML4KcknobcAsg3QZoIFp+2wmxWSCdAKl4QCFZEigABEBuh/XWYA+g7l3E6/CBsJUtAdIQSIqAgrOSfSCPz1vKxkDdk/ggc8GdSzCQmezW3wGZrXW7h93khUA+VAgkwYouADof2udvFLzBUvDwbpP857ApUPCUrHa+MiDNAWkAZFfqAqCS8A2WIiBZBGSPv3Kg8QcPyBy8dh28ddsXqOD2OBMgXQSkEZDbYo2BtDqgghsspYDU/Vm7M0MxkE6BPBQNgQQAyd5AK/egAMiuaxpIpkCaBbJLCoD0lkAFN1hCQHZdxQPSJUA6BfKGmFE3Ayq4wZL/UwxkZwvW2geyKOVAZvHu59sBlS7OAikEMnPGQHacA5LlQN4Weq9Gvw+Q+X0IZM9NageWAKl6QGZNPCCpFEgjIC0CGpfjjpUEkNtzPEj3JHBHQLoQyA2NgWQOyBx6y7Zoq2Ig84vLgXQLIL0bILecMqDpnpYD0iqBoodKA7mDMrFe7swSUcdg/hNCMCn+KmgbILElF4r/0Hyg+Vnih45nk8xCvHlvvAfVH4FABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCHTbb5h9g7gHgQgEIhCIQKCdgEqvUay/fYCKr1Gsv12Ayq8wq79dgMqvUaw/7kGgvc5Bhdco1t9Oz2Kl1yjWH18HgQgE2huI//jR3o976wgE4jfMQNyDQAQC7fRezB1KfBZLlf2H6dYt7pbt9g0zcPsK+TbtA9S+S83cemrRQsH0yyZfOvyy2bdZKIEum/7dgbzvm61cKIEum04gAl02nUB3DnT5Qn97oHuKQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhBoe6BGJHFX2P4K65dgenrGdJ8/hpvprxr9+edHemjJMjYHarp73kcP+/XWfunUbaOdnp4xs9CnX3o+rBx9PvR/3RkPLVrG1kDDd9OO079fHP45jtPjh52emXFmoStHN8Pfk8dDy5axNZCVSK7rw7udPjvjdKF/vE+WXj66kZf+ou54aNkyNgfqtyVznfmxXSszfXbGSc3jz0N/Bls1epgtHlq2jK2BhmM6fWR3V1fb6XMzTjt1B0l3XcCq0YNBPLRsGVcEasw5ejnQw/hnfQdA+f12uDp/1UEynCfac8YdHGLZM9/4UapVJ+lhI9oNWjVaqzpJ5547zcc8Vj3NDx8zala+SBiAanmaz7z6+vzxMp2+5IVi9+GifnvWvcys6YVi/2+7xA96Gi7r6ibY6ckZMzXmjcqa0eNpJh5asgy+WQURCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgEIFABAIRCEQgUH1A0eUEpdco7BOBQAQCVQl0PvxzkP6Kq+4ClX/Hi2a661+668HOB3Rjgy2rFKi7Lr/9/9h6NDL+prsIq7uKKner5n2qFOhluGazv4rwOH6hvxCqefz511WPuEqBXvsLE+21c8NpqPc6StmFiVtVNdDJAo13ZnstvYvadlUNNNmDur7e/i679nerqgYar2Qev9B3evoP3p1n06oG6p+87LPYcLZ+Lb2+fqPqBgpfB7Uwx/6C6WuepusDqiwCgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhCIQCACgQgEIhDof/L1lHfutV9OAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3:</h2>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3:</h2>
<p>对于Question1，选取<span class="math inline">\(\psi_{ij}\)</span>为第<span class="math inline">\(i\)</span>条链直到时间<span class="math inline">\(j\)</span>的样本均值. 对于Question2，选取<span class="math inline">\(\psi_{ij}\)</span>为第<span class="math inline">\(i\)</span>条链直到时间<span class="math inline">\(j\)</span>的<span class="math inline">\(y\)</span>的样本均值.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>GR <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> B<span class="sc">/</span>n</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>}</span></code></pre></div>
<div id="question-1-1" class="section level3">
<h3>Question 1:</h3>
<p>因为Cauchy厚尾，所以随机游走容易滞留在尾部. 因此我取较大的<span class="math inline">\(\sigma\)</span>，使得随机游走每一步走得尽量的远，一定程度上减少滞留的时间.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241101</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">8000</span></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(x0), <span class="at">ncol=</span>N)</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">CauchyGenerator</span>(N, theta, eta, x0[i], sigma)</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>}</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a></span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a>  psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>}</span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb113-20"><a href="#cb113-20" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb113-21"><a href="#cb113-21" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb113-22"><a href="#cb113-22" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb114-5"><a href="#cb114-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">which</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]<span class="sc">&lt;</span><span class="fl">1.2</span>)[<span class="dv">1</span>]</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>N0</span></code></pre></div>
<pre><code>## [1] 5078</code></pre>
<p>N0即为<span class="math inline">\(\hat{R}\)</span>第一次小于1.2的时刻.</p>
<p>N0之前的链如下所示：</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>  <span class="fu">plot</span>(X[i, <span class="dv">1</span><span class="sc">:</span>N0], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="question-2" class="section level3">
<h3>Question 2:</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241102</span>)</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a></span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(x0), <span class="at">ncol=</span>N)</span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(x0), <span class="at">ncol=</span>N)</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">GibbsSampler</span>(N, <span class="fu">c</span>(x0[i], y0[i]), a, b, n)</span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(z[, <span class="dv">1</span>])</span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a>  Y[i, ] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(z[, <span class="dv">2</span>])</span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a>}</span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(Y, <span class="dv">1</span>, cumsum))</span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) {</span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a>  psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a>}</span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">GR</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb119-26"><a href="#cb119-26" tabindex="-1"></a>}</span>
<span id="cb119-27"><a href="#cb119-27" tabindex="-1"></a></span>
<span id="cb119-28"><a href="#cb119-28" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb119-29"><a href="#cb119-29" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb119-30"><a href="#cb119-30" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb119-31"><a href="#cb119-31" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb119-32"><a href="#cb119-32" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a><span class="fu">plot</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="fu">which</span>(rhat[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]<span class="sc">&lt;</span><span class="fl">1.2</span>)[<span class="dv">1</span>]</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>N0</span></code></pre></div>
<pre><code>## [1] 1011</code></pre>
<p>N0即为<span class="math inline">\(\hat{R}\)</span>第一次小于1.2的时刻.</p>
<p>N0之前的链如下所示：</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x0)) {</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>  <span class="fu">plot</span>(X[i, <span class="dv">1</span><span class="sc">:</span>N0], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>  <span class="fu">lines</span>(Y[i, <span class="dv">1</span><span class="sc">:</span>N0], <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="question-1-exercise-11.3" class="section level2">
<h2>Question 1: Exercise 11.3</h2>
<ol style="list-style-type: lower-alpha">
<li>Write a function to compute the <span class="math inline">\(k\)</span>th term in <span class="math display">\[
\sum_{k=0}^\infty\frac{(-1)^k}{k!2^k}\frac{\|a\|^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma\left(\frac{d+1}{2}\right)\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},
\]</span> where <span class="math inline">\(d \ge 1\)</span> is an
integer, <span class="math inline">\(a\)</span> is a vector in <span class="math inline">\(\mathbb{R}^d\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean
norm.</li>
</ol>
<p>Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a\in\mathbb{R}^d\)</span>.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a = (1,
2)^T\)</span> .</p></li>
</ol>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1:</h2>
<div id="a." class="section level3">
<h3>(a).</h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>kthTerm <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, k) {</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>  <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="fl">+1.5</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">10000</span>, <span class="dv">10001</span>)</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">101</span>, <span class="dv">10000</span>, <span class="dv">10001</span>)</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241107</span>)</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> ks) {</span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> ds) {</span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(d) <span class="co"># 随机取一个a</span></span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">c</span>(result, <span class="fu">kthTerm</span>(d, a, k))</span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a>  }</span>
<span id="cb125-11"><a href="#cb125-11" tabindex="-1"></a>}</span>
<span id="cb125-12"><a href="#cb125-12" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##  [1]   3.541354e-02   6.809568e-02   1.869390e+01   3.156161e+01   1.254191e+01
##  [6]   2.354409e+02   2.579831e+02  -8.198494e-01  -3.288205e-02  -2.802165e+00
## [11]  -3.260685e+00  -3.503236e+01  -2.911114e+02  -3.687126e+02   4.612496e-14
## [16]   1.949533e-08   3.222687e-01   3.680398e+01   1.201279e+01   4.251364e+02
## [21]   3.814412e+02  5.126006e-195  7.506371e-124  2.259044e-102   9.935498e-30
## [26]   5.465263e-29   4.354534e+02   2.432012e+02 -2.543752e-256 -1.488516e-227
## [31]  -2.366522e-96  -1.307243e-30  -2.348179e-20  -6.728979e+02  -8.399083e+01
## [36]   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00
## [41]   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00
## [46]   0.000000e+00   0.000000e+00   0.000000e+00   0.000000e+00</code></pre>
<p>可见对于几乎任意大的<span class="math inline">\(k\)</span>和<span class="math inline">\(d\)</span>，上述函数仍然能有效运行.</p>
</div>
<div id="b." class="section level3">
<h3>(b).</h3>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>SumComputer <span class="ot">&lt;-</span> <span class="cf">function</span>(d, a, error) {</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">kthTerm</span>(d, a, <span class="dv">0</span>)</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>  term <span class="ot">&lt;-</span> <span class="fu">kthTerm</span>(d, a, k)</span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>  <span class="cf">while</span> (term <span class="sc">&gt;</span> error) {</span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>    result <span class="ot">&lt;-</span> result <span class="sc">+</span> term</span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">kthTerm</span>(d, a, k)</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>  }</span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241107</span>)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fl">1e-5</span></span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> ds) {</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(d) <span class="co"># 随机取一个a</span></span>
<span id="cb128-6"><a href="#cb128-6" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">c</span>(result, <span class="fu">SumComputer</span>(d, a, error))</span>
<span id="cb128-7"><a href="#cb128-7" tabindex="-1"></a>}</span>
<span id="cb128-8"><a href="#cb128-8" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## [1]   0.6539126   0.8666002   6.3020656  14.0792633  10.3835497 125.4333810
## [7] 129.3195055</code></pre>
<p>运行效果不错.</p>
</div>
<div id="c." class="section level3">
<h3>(c).</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fl">1e-5</span></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="fu">SumComputer</span>(d, a, error)</span></code></pre></div>
<pre><code>## [1] 3.926991</code></pre>
</div>
</div>
<div id="question-2-exercise-11.5" class="section level2">
<h2>Question 2: Exercise 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
\frac{2\Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}\Gamma\left(\frac{k-1}{2}\right)}\int_0^{c_{k-1}}\left(1+\frac{u^2}{k-1}\right)^{-k/2}\mathrm{d}u=\frac{2\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi
k}\Gamma\left(\frac{k}{2}\right)}\int_0^{c_k}\left(1+\frac{u^2}{k}\right)^{-(k+1)/2}\mathrm{d}u
\]</span> for a, where <span class="math display">\[c_k=\sqrt{\frac{a^2k}{k+1-a^2}}.\]</span> Compare
the solutions with the points <span class="math inline">\(A(k)\)</span>
in Exercise 11.4.</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2:</h2>
<div id="计算零点" class="section level3">
<h3>计算零点:</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co"># 被积函数</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>}</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a><span class="co"># 计算c_k</span></span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a>ck <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>EquationSolver <span class="ot">&lt;-</span> <span class="cf">function</span>(k, interval) {</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>  target <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>    c1 <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k<span class="dv">-1</span>)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>    c2 <span class="ot">&lt;-</span> <span class="fu">ck</span>(a, k)</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>    I1 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span>c1, <span class="at">k=</span>k<span class="dv">-1</span>)<span class="sc">$</span>value</span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>    I2 <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span>c2, <span class="at">k=</span>k)<span class="sc">$</span>value</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(k<span class="dv">-1</span>)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">log</span>(I1)<span class="sc">-</span><span class="fu">lgamma</span>((k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>(k)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(I2))</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>  }</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(target, interval)</span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> ks) {</span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>  result1 <span class="ot">&lt;-</span> <span class="fu">c</span>(result1, <span class="fu">EquationSolver</span>(k, <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.01</span>)))</span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>}</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">k=</span>ks, <span class="at">solution=</span>result1)</span></code></pre></div>
<pre><code>##       k solution
## 1     4 1.207461
## 2     5 1.216637
## 3     6 1.222491
## 4     7 1.226471
## 5     8 1.229362
## 6     9 1.231550
## 7    10 1.233261
## 8    11 1.234635
## 9    12 1.235761
## 10   13 1.236701
## 11   14 1.237505
## 12   15 1.238177
## 13   16 1.238768
## 14   17 1.239286
## 15   18 1.239742
## 16   19 1.240149
## 17   20 1.240510
## 18   21 1.240838
## 19   22 1.241138
## 20   23 1.241418
## 21   24 1.241673
## 22   25 1.241869
## 23  100 1.245757
## 24  500 1.246769
## 25 1000 1.246866</code></pre>
</div>
<div id="比较-1" class="section level3">
<h3>比较:</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> ks) {</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="at">f=</span><span class="cf">function</span>(a) {</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>    <span class="fu">pt</span>(<span class="fu">ck</span>(a, k<span class="dv">-1</span>), k<span class="dv">-1</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)<span class="sc">-</span><span class="fu">pt</span>(<span class="fu">ck</span>(a, k), k, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>    }, </span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fu">sqrt</span>(k)<span class="sc">-</span><span class="fl">0.01</span>))</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>  result2 <span class="ot">&lt;-</span> <span class="fu">c</span>(result2, solution<span class="sc">$</span>root)</span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>}</span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">k=</span>ks, <span class="at">sqrt.k=</span><span class="fu">sqrt</span>(ks), <span class="at">Exercise11.4=</span>result2, <span class="at">Exercise11.5=</span>result1)</span></code></pre></div>
<pre><code>##       k    sqrt.k Exercise11.4 Exercise11.5
## 1     4  2.000000     1.492073     1.207461
## 2     5  2.236068     1.533555     1.216637
## 3     6  2.449490     1.562745     1.222491
## 4     7  2.645751     1.584429     1.226471
## 5     8  2.828427     1.601184     1.229362
## 6     9  3.000000     1.614516     1.231550
## 7    10  3.162278     1.625389     1.233261
## 8    11  3.316625     1.634418     1.234635
## 9    12  3.464102     1.642026     1.235761
## 10   13  3.605551     1.648552     1.236701
## 11   14  3.741657     1.654175     1.237505
## 12   15  3.872983     1.659099     1.238177
## 13   16  4.000000     1.663454     1.238768
## 14   17  4.123106     1.667287     1.239286
## 15   18  4.242641     1.670733     1.239742
## 16   19  4.358899     1.673832     1.240149
## 17   20  4.472136     1.676605     1.240510
## 18   21  4.582576     1.679148     1.240838
## 19   22  4.690416     1.681468     1.241138
## 20   23  4.795832     1.683593     1.241418
## 21   24  4.898979     1.685546     1.241673
## 22   25  5.000000     1.687366     1.241869
## 23  100 10.000000     1.720607     1.245757
## 24  500 22.360680    22.350680     1.246769
## 25 1000 31.622777    31.612777     1.246866</code></pre>
<p>注意到Exercise 11.4得到的结果总是比Exercise
11.5得到的结果大，并且从<span class="math inline">\(k=500\)</span>开始，Exercise
11.4倾向于取右端点<span class="math inline">\(a=\sqrt{k}-0.01\)</span>而不能求得真正的解.</p>
</div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3:</h2>
<p>Suppose <span class="math inline">\(T_1,\dots, T_n\)</span> are
i.i.d. samples drawn from the exponential distribution with expectation
<span class="math inline">\(\lambda\)</span>. Those values greater than
<span class="math inline">\(\tau\)</span> are not observed due to right
censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(T_i ≤ \tau ) + \tau I(T_i &gt; τ ),\ i
= 1,\dots , n\)</span>. Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00,
0.21, 0.85\]</span> Use the E-M algorithm to estimate <span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note: Yi follows a mixture distribution).</p>
</div>
<div id="answer-3-7" class="section level2">
<h2>Answer 3:</h2>
<div id="em算法" class="section level3">
<h3>EM算法</h3>
<p><span class="math inline">\(T_1,\dots,T_n\)</span>的对数似然为 <span class="math display">\[l=\sum_{i=1}^n\log\left(\frac{1}{\lambda}e^{-T_i/\lambda}\right)=-\frac{1}{\lambda}\sum_{i=1}^nT_i-n\log(\lambda).\]</span></p>
<p>观测数据设为<span class="math inline">\(T_1,\dots,T_m\)</span>和<span class="math inline">\(X_{m+1}=I(T_{m+1}&gt;\tau),\cdots,X_n=I(T_{n}&gt;\tau)\)</span>，记<span class="math inline">\(X^{(0)}=(T_1,\dots,T_m,X_{m+1},\dots,X_n)\)</span>.</p>
<p>E-Step:</p>
<p><span class="math display">\[l_k=\mathbb{E}_{\hat{\lambda}_k}(l|X^{(o)})=-\frac{1}{\lambda}\sum_{i=1}^mT_i-\frac{1}{\lambda}\sum_{i=m+1}^n\mathbb{E}(T_i|X_i)-n\log(\lambda).\]</span></p>
<p>在<span class="math inline">\(X_i\)</span>均为1的情况下，上式等于
<span class="math display">\[l_k=-\frac{1}{\lambda}\sum_{i=1}^mT_i-\frac{n-m}{\lambda}(\hat\lambda_k+\tau)-n\log\lambda.\]</span></p>
<p>M-Step:</p>
<p><span class="math display">\[\frac{\partial
l_k}{\partial\lambda}=\frac{1}{\lambda^2}\sum_{i=1}^m
T_i+\frac{(n-m)(\hat{\lambda}_k+\tau)}{\lambda^2}-\frac{n}{\lambda}.\]</span></p>
<p>因此 <span class="math display">\[\hat{\lambda}_{k+1}=\frac{1}{n}\sum_{i=1}^mT_i+\frac{n-m}{n}(\hat\lambda_k+\tau)=\frac{1}{n}\sum_{i=1}^nY_i+\frac{n-m}{n}\hat\lambda_k.\]</span></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>Ys <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(Ys, N, lambda0) {</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda0</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ys<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Ys)</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(Ys) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> m<span class="sc">/</span>n)<span class="sc">*</span>lambda</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>  }</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> <span class="fu">EM</span>(Ys, <span class="dv">100</span>, <span class="fl">0.1</span>)</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>lambda1</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
</div>
<div id="mle" class="section level3">
<h3>MLE</h3>
<p><span class="math inline">\(P(Y_i=1)=e^{-1/\lambda}\)</span>，因此<span class="math inline">\(Y_1,\dots,Y_n\)</span>的对数似然为 <span class="math display">\[l=\sum_{i=1}^n\left[\log\left(\frac{1}{\lambda}e^{-Y_i/\lambda}\right)I(Y_i&lt;1)+\log(e^{-1/\lambda})I(Y_i=1)\right].\]</span>
则 <span class="math display">\[\frac{\partial
l}{\partial\lambda}=-\frac{\sum_{i=1}^nI(Y_i&lt;1)}{\lambda}+\frac{\sum_{i=1}^nY_iI(Y_i&lt;1)}{\lambda^2}+\frac{\sum_{i=1}^nI(Y_i=1)}{\lambda^2}.\]</span>
因此MLE为 <span class="math display">\[\hat{\lambda}=\frac{\sum_{i=1}^nY_iI(Y_i&lt;1)+\sum_{i=1}^nI(Y_i=1)}{\sum_{i=1}^nI(Y_i&lt;1)}=\frac{\sum_{i=1}^n
Y_i}{\sum_{i=1}^nI(Y_i&lt;1)}.\]</span></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>lambda2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(Ys)<span class="sc">/</span><span class="fu">sum</span>(Ys<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a>lambda2</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>可见两种估计的结果一致.</p>
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1:</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4x + 2y + 9z\)</span> subject to <span class="math display">\[
\begin{aligned}
  &amp; 2x + y + z ≤ 2 \\
  &amp; x − y + 3z ≤ 3 \\
  &amp; x ≥ 0, y ≥ 0, z ≥ 0.
\end{aligned}
\]</span></p>
</div>
<div id="answer-1-8" class="section level2">
<h2>Answer 1:</h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>f.obj <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>f.con <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>), <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>f.dir <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="dv">2</span>)</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>f.rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>res.lp <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, f.obj, f.con, f.dir, f.rhs)</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>res.lp<span class="sc">$</span>solution</span></code></pre></div>
<pre><code>## [1] 0 0 0</code></pre>
<p>可见最小值为0.</p>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2:</h2>
<p>Use both for loops and <code>lapply()</code> to fit linear models to
the <code>mtcars</code> using the formulas stored in this list:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="answer-2-8" class="section level2">
<h2>Answer 2:</h2>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>lms21 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>  lms21[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], mtcars)</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>}</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>lms21</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>lms22 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, lm, <span class="at">data=</span>mtcars)</span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>lms22</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3:</h2>
<p>Fit the model <code>mpg ~ disp</code> to each of the bootstrap
replicates of <code>mtcars</code> in the list below by using a for loop
and <code>lapply()</code>. Can you do it without an anonymous
function?</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="answer-3-8" class="section level2">
<h2>Answer 3:</h2>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241114</span>)</span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>lms31 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>  lms31[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, bootstraps[[i]])</span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a>}</span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a>lms31</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.96839     -0.04381  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.70091     -0.04663  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.91196     -0.04323  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.76612     -0.04925  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.76474     -0.04355  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.02842     -0.03876  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.92314     -0.05044  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.22764     -0.03742  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.90533     -0.04271  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47461     -0.03316</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>lms32 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, lm, <span class="at">formula=</span>mpg <span class="sc">~</span> disp)</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>lms32</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.96839     -0.04381  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.70091     -0.04663  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.91196     -0.04323  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.76612     -0.04925  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.76474     -0.04355  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.02842     -0.03876  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.92314     -0.05044  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.22764     -0.03742  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.90533     -0.04271  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47461     -0.03316</code></pre>
<p>如果不使用匿名函数，代码如下</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241116</span>)</span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>lms33 <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep=</span><span class="cn">TRUE</span>)</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a>  lms33[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula=</span>mpg<span class="sc">~</span>disp ,<span class="at">data=</span>mtcars[rows,])</span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a>}</span>
<span id="cb158-7"><a href="#cb158-7" tabindex="-1"></a>lms33</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    29.69501     -0.04115  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    29.80785     -0.04244  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    28.91877     -0.04082  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    31.00939     -0.04628  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    28.14692     -0.03325  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    28.95056     -0.03941  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    28.84772     -0.03994  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##     28.3447      -0.0361  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##     30.4483      -0.0446  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = mtcars[rows, ])
## 
## Coefficients:
## (Intercept)         disp  
##    31.64238     -0.04915</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4:</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4:</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a>rs2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lms22, rsq) <span class="co"># Question2的模型</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a>rs3 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lms32, rsq) <span class="co"># Question3的模型</span></span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a><span class="fu">as.numeric</span>(rs2) </span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">as.numeric</span>(rs3)</span></code></pre></div>
<pre><code>##  [1] 0.7005150 0.7743866 0.7347297 0.7669243 0.7559898 0.6546903 0.8312877
##  [8] 0.7529622 0.6977379 0.6593471</code></pre>
</div>
<div id="question-5" class="section level2">
<h2>Question 5:</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use <code>sapply()</code> and an anonymous function to
extract the p-value from every trial.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), </span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using
<code>[[</code> directly.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5:</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241116</span>)</span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)), </span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>  <span class="at">simplify=</span><span class="cn">FALSE</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a>)</span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(trial) trial<span class="sc">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.048992381 0.224751390 0.008690355 0.551448947 0.721698488 0.032845422
##   [7] 0.805104529 0.020180967 0.259555290 0.019147479 0.944756489 0.869429946
##  [13] 0.553637661 0.416586738 0.345008403 0.581250736 0.348179355 0.861954133
##  [19] 0.828501008 0.613204415 0.863329338 0.787209589 0.146408775 0.228681554
##  [25] 0.943050945 0.168174917 0.336473442 0.235001878 0.262447127 0.573592631
##  [31] 0.054003994 0.228673069 0.261405316 0.811792792 0.171856746 0.601685939
##  [37] 0.065479295 0.498554760 0.417241561 0.515797639 0.949731258 0.592490799
##  [43] 0.546204586 0.548417759 0.597316362 0.535122608 0.021773069 0.808323651
##  [49] 0.635605572 0.677015235 0.018144807 0.666194705 0.946421280 0.337121338
##  [55] 0.423997175 0.334820024 0.888295671 0.942855017 0.299359292 0.309643133
##  [61] 0.305446504 0.291457783 0.113001404 0.931572970 0.219978043 0.160250030
##  [67] 0.095276865 0.139273371 0.421737376 0.846930022 0.379917483 0.136128997
##  [73] 0.410146338 0.442244584 0.049136670 0.365238174 0.077584252 0.678253402
##  [79] 0.786358335 0.426125190 0.304676607 0.708081886 0.654393723 0.320867186
##  [85] 0.591635058 0.503868674 0.895891526 0.791125310 0.291497708 0.417087713
##  [91] 0.158276185 0.678324948 0.371728385 0.383465293 0.285780373 0.665902778
##  [97] 0.470552263 0.230436742 0.636284795 0.545425755</code></pre>
<p>如果不使用匿名函数而是使用[[，代码如下</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.048992381 0.224751390 0.008690355 0.551448947 0.721698488 0.032845422
##   [7] 0.805104529 0.020180967 0.259555290 0.019147479 0.944756489 0.869429946
##  [13] 0.553637661 0.416586738 0.345008403 0.581250736 0.348179355 0.861954133
##  [19] 0.828501008 0.613204415 0.863329338 0.787209589 0.146408775 0.228681554
##  [25] 0.943050945 0.168174917 0.336473442 0.235001878 0.262447127 0.573592631
##  [31] 0.054003994 0.228673069 0.261405316 0.811792792 0.171856746 0.601685939
##  [37] 0.065479295 0.498554760 0.417241561 0.515797639 0.949731258 0.592490799
##  [43] 0.546204586 0.548417759 0.597316362 0.535122608 0.021773069 0.808323651
##  [49] 0.635605572 0.677015235 0.018144807 0.666194705 0.946421280 0.337121338
##  [55] 0.423997175 0.334820024 0.888295671 0.942855017 0.299359292 0.309643133
##  [61] 0.305446504 0.291457783 0.113001404 0.931572970 0.219978043 0.160250030
##  [67] 0.095276865 0.139273371 0.421737376 0.846930022 0.379917483 0.136128997
##  [73] 0.410146338 0.442244584 0.049136670 0.365238174 0.077584252 0.678253402
##  [79] 0.786358335 0.426125190 0.304676607 0.708081886 0.654393723 0.320867186
##  [85] 0.591635058 0.503868674 0.895891526 0.791125310 0.291497708 0.417087713
##  [91] 0.158276185 0.678324948 0.371728385 0.383465293 0.285780373 0.665902778
##  [97] 0.470552263 0.230436742 0.636284795 0.545425755</code></pre>
</div>
<div id="question-6" class="section level2">
<h2>Question 6:</h2>
<p>Implement a combination of <code>Map()</code> and
<code>vapply()</code> to create an <code>lapply()</code> variant that
iterates in parallel over all of its inputs and stores its outputs in a
vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer 6:</h2>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a>Newlappy <span class="ot">&lt;-</span> <span class="cf">function</span>(fun, ..., FUN.VALUE) {</span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">Map</span>(fun, ...)</span>
<span id="cb171-3"><a href="#cb171-3" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">vapply</span>(tmp, <span class="at">FUN=</span>identity, <span class="at">FUN.VALUE=</span>FUN.VALUE)</span>
<span id="cb171-4"><a href="#cb171-4" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb171-5"><a href="#cb171-5" tabindex="-1"></a>}</span></code></pre></div>
<p>通过一个例子来检验</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a><span class="fu">Newlappy</span>(<span class="cf">function</span>(x,y) <span class="fu">mean</span>(x<span class="sc">+</span>y), a, b, <span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 6 3</code></pre>
</div>
<div id="question-7" class="section level2">
<h2>Question 7:</h2>
<p>Make a faster version of <code>chisq.test()</code> that only computes
the chi-square test statistic when the input is two numeric vectors with
no missing values. You can try simplifying <code>chisq.test()</code> or
by coding from the mathematical definition.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer 7:</h2>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>NewChisqTest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)  </span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a>  row_nums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data)  </span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>  col_nums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(data)  </span>
<span id="cb174-6"><a href="#cb174-6" tabindex="-1"></a>  </span>
<span id="cb174-7"><a href="#cb174-7" tabindex="-1"></a>  Es <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">ncol =</span> <span class="fu">ncol</span>(data))  </span>
<span id="cb174-8"><a href="#cb174-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {  </span>
<span id="cb174-9"><a href="#cb174-9" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {  </span>
<span id="cb174-10"><a href="#cb174-10" tabindex="-1"></a>      Es[i, j] <span class="ot">&lt;-</span> (row_nums[i] <span class="sc">*</span> col_nums[j]) <span class="sc">/</span> N  </span>
<span id="cb174-11"><a href="#cb174-11" tabindex="-1"></a>    }  </span>
<span id="cb174-12"><a href="#cb174-12" tabindex="-1"></a>  }  </span>
<span id="cb174-13"><a href="#cb174-13" tabindex="-1"></a>  </span>
<span id="cb174-14"><a href="#cb174-14" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data)</span>
<span id="cb174-15"><a href="#cb174-15" tabindex="-1"></a>  Es <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Es)</span>
<span id="cb174-16"><a href="#cb174-16" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sum</span>((data <span class="sc">-</span> Es)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Es)  </span>
<span id="cb174-17"><a href="#cb174-17" tabindex="-1"></a></span>
<span id="cb174-18"><a href="#cb174-18" tabindex="-1"></a>  <span class="fu">return</span>(result)  </span>
<span id="cb174-19"><a href="#cb174-19" tabindex="-1"></a>}</span></code></pre></div>
<p>用一个实验来验证此函数的正确性和快速性</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241116</span>)</span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb175-4"><a href="#cb175-4" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))<span class="sc">$</span>statistic)</span>
<span id="cb175-6"><a href="#cb175-6" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">NewChisqTest</span>(x, y)</span>
<span id="cb175-7"><a href="#cb175-7" tabindex="-1"></a></span>
<span id="cb175-8"><a href="#cb175-8" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb175-9"><a href="#cb175-9" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb175-10"><a href="#cb175-10" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb175-11"><a href="#cb175-11" tabindex="-1"></a>    start1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb175-12"><a href="#cb175-12" tabindex="-1"></a>    test1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))<span class="sc">$</span>statistic)</span>
<span id="cb175-13"><a href="#cb175-13" tabindex="-1"></a>    end1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb175-14"><a href="#cb175-14" tabindex="-1"></a>    end1 <span class="sc">-</span> start1</span>
<span id="cb175-15"><a href="#cb175-15" tabindex="-1"></a>  })</span>
<span id="cb175-16"><a href="#cb175-16" tabindex="-1"></a></span>
<span id="cb175-17"><a href="#cb175-17" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb175-18"><a href="#cb175-18" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb175-19"><a href="#cb175-19" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb175-20"><a href="#cb175-20" tabindex="-1"></a>    start2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb175-21"><a href="#cb175-21" tabindex="-1"></a>    test2 <span class="ot">&lt;-</span> <span class="fu">NewChisqTest</span>(x, y)</span>
<span id="cb175-22"><a href="#cb175-22" tabindex="-1"></a>    end2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb175-23"><a href="#cb175-23" tabindex="-1"></a>    end2 <span class="sc">-</span> start2</span>
<span id="cb175-24"><a href="#cb175-24" tabindex="-1"></a>  })</span>
<span id="cb175-25"><a href="#cb175-25" tabindex="-1"></a></span>
<span id="cb175-26"><a href="#cb175-26" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">fun=</span><span class="fu">c</span>(<span class="st">&quot;chisq.test&quot;</span>, <span class="st">&quot;New&quot;</span>), <span class="at">value=</span><span class="fu">c</span>(test1, test2), <span class="at">time=</span><span class="fu">c</span>(<span class="fu">mean</span>(time1), <span class="fu">mean</span>(time2)))</span></code></pre></div>
<pre><code>##          fun    value         time
## 1 chisq.test 8.931568 0.0004590490
## 2        New 8.931568 0.0003053987</code></pre>
<p>可见新函数的计算结果是准确的，并且运行时间更短.</p>
</div>
<div id="question-8" class="section level2">
<h2>Question 8:</h2>
<p>Can you make a faster version of <code>table()</code> for the case of
an input of two integer vectors with no missing values? Can you use it
to speed up your chi-square test?</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer 8:</h2>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>NewTable <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb177-2"><a href="#cb177-2" tabindex="-1"></a>  x.new <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb177-3"><a href="#cb177-3" tabindex="-1"></a>  y.new <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb177-4"><a href="#cb177-4" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="fu">length</span>(x.new), <span class="at">ncol=</span><span class="fu">length</span>(y.new))</span>
<span id="cb177-5"><a href="#cb177-5" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> x.new</span>
<span id="cb177-6"><a href="#cb177-6" tabindex="-1"></a>  <span class="fu">colnames</span>(result) <span class="ot">&lt;-</span> y.new</span>
<span id="cb177-7"><a href="#cb177-7" tabindex="-1"></a>  </span>
<span id="cb177-8"><a href="#cb177-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)) {</span>
<span id="cb177-9"><a href="#cb177-9" tabindex="-1"></a>    row_index <span class="ot">&lt;-</span> <span class="fu">match</span>(x[i], x.new)</span>
<span id="cb177-10"><a href="#cb177-10" tabindex="-1"></a>    col_index <span class="ot">&lt;-</span> <span class="fu">match</span>(y[i], y.new)</span>
<span id="cb177-11"><a href="#cb177-11" tabindex="-1"></a>    result[row_index, col_index] <span class="ot">&lt;-</span> result[row_index, col_index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb177-12"><a href="#cb177-12" tabindex="-1"></a>  }</span>
<span id="cb177-13"><a href="#cb177-13" tabindex="-1"></a>  </span>
<span id="cb177-14"><a href="#cb177-14" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb177-15"><a href="#cb177-15" tabindex="-1"></a>}</span></code></pre></div>
<p>下面用一个实验来检验此函数</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241116</span>)</span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb178-3"><a href="#cb178-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb178-4"><a href="#cb178-4" tabindex="-1"></a></span>
<span id="cb178-5"><a href="#cb178-5" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb178-6"><a href="#cb178-6" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">NewTable</span>(x, y)</span>
<span id="cb178-7"><a href="#cb178-7" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb178-9"><a href="#cb178-9" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb178-10"><a href="#cb178-10" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb178-11"><a href="#cb178-11" tabindex="-1"></a>    start1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb178-12"><a href="#cb178-12" tabindex="-1"></a>    test1 <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb178-13"><a href="#cb178-13" tabindex="-1"></a>    end1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb178-14"><a href="#cb178-14" tabindex="-1"></a>    end1 <span class="sc">-</span> start1</span>
<span id="cb178-15"><a href="#cb178-15" tabindex="-1"></a>  })</span>
<span id="cb178-16"><a href="#cb178-16" tabindex="-1"></a></span>
<span id="cb178-17"><a href="#cb178-17" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb178-18"><a href="#cb178-18" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb178-19"><a href="#cb178-19" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb178-20"><a href="#cb178-20" tabindex="-1"></a>    start2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb178-21"><a href="#cb178-21" tabindex="-1"></a>    test2 <span class="ot">&lt;-</span> <span class="fu">NewTable</span>(x, y)</span>
<span id="cb178-22"><a href="#cb178-22" tabindex="-1"></a>    end2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb178-23"><a href="#cb178-23" tabindex="-1"></a>    end2 <span class="sc">-</span> start2</span>
<span id="cb178-24"><a href="#cb178-24" tabindex="-1"></a>  })</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a>result1</span></code></pre></div>
<pre><code>##    y
## x    1  2
##   1  2 11
##   2  8  3
##   3  6  4
##   4  5  6
##   5  2  3</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="fu">mean</span>(time1)</span></code></pre></div>
<pre><code>## [1] 0.0001981878</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a>result2</span></code></pre></div>
<pre><code>##    2 1
## 1 11 2
## 5  3 2
## 3  4 6
## 4  6 5
## 2  3 8</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a><span class="fu">mean</span>(time2)</span></code></pre></div>
<pre><code>## [1] 0.0001009576</code></pre>
<p>可见新函数结果准确并且速度更快.</p>
<p>如果将此函数使用到我的卡方检验函数中，可得如下函数</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a>NewNewChisqTest <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">NewTable</span>(x, y)  </span>
<span id="cb187-3"><a href="#cb187-3" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb187-4"><a href="#cb187-4" tabindex="-1"></a>  row_nums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data)  </span>
<span id="cb187-5"><a href="#cb187-5" tabindex="-1"></a>  col_nums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(data)  </span>
<span id="cb187-6"><a href="#cb187-6" tabindex="-1"></a>  </span>
<span id="cb187-7"><a href="#cb187-7" tabindex="-1"></a>  Es <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(data), <span class="at">ncol =</span> <span class="fu">ncol</span>(data))  </span>
<span id="cb187-8"><a href="#cb187-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {  </span>
<span id="cb187-9"><a href="#cb187-9" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {  </span>
<span id="cb187-10"><a href="#cb187-10" tabindex="-1"></a>      Es[i, j] <span class="ot">&lt;-</span> (row_nums[i] <span class="sc">*</span> col_nums[j]) <span class="sc">/</span> N  </span>
<span id="cb187-11"><a href="#cb187-11" tabindex="-1"></a>    }  </span>
<span id="cb187-12"><a href="#cb187-12" tabindex="-1"></a>  }  </span>
<span id="cb187-13"><a href="#cb187-13" tabindex="-1"></a>  </span>
<span id="cb187-14"><a href="#cb187-14" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data)</span>
<span id="cb187-15"><a href="#cb187-15" tabindex="-1"></a>  Es <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Es)</span>
<span id="cb187-16"><a href="#cb187-16" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">sum</span>((data <span class="sc">-</span> Es)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Es)  </span>
<span id="cb187-17"><a href="#cb187-17" tabindex="-1"></a></span>
<span id="cb187-18"><a href="#cb187-18" tabindex="-1"></a>  <span class="fu">return</span>(result)  </span>
<span id="cb187-19"><a href="#cb187-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241116</span>)</span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">50</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a></span>
<span id="cb188-5"><a href="#cb188-5" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))<span class="sc">$</span>statistic)</span>
<span id="cb188-6"><a href="#cb188-6" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">NewChisqTest</span>(x, y)</span>
<span id="cb188-7"><a href="#cb188-7" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">NewNewChisqTest</span>(x, y)</span>
<span id="cb188-8"><a href="#cb188-8" tabindex="-1"></a></span>
<span id="cb188-9"><a href="#cb188-9" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" tabindex="-1"></a>time1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb188-11"><a href="#cb188-11" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb188-12"><a href="#cb188-12" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb188-13"><a href="#cb188-13" tabindex="-1"></a>    start1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-14"><a href="#cb188-14" tabindex="-1"></a>    test1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">chisq.test</span>(<span class="fu">table</span>(x, y))<span class="sc">$</span>statistic)</span>
<span id="cb188-15"><a href="#cb188-15" tabindex="-1"></a>    end1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-16"><a href="#cb188-16" tabindex="-1"></a>    end1 <span class="sc">-</span> start1</span>
<span id="cb188-17"><a href="#cb188-17" tabindex="-1"></a>  })</span>
<span id="cb188-18"><a href="#cb188-18" tabindex="-1"></a></span>
<span id="cb188-19"><a href="#cb188-19" tabindex="-1"></a>time2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb188-20"><a href="#cb188-20" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb188-21"><a href="#cb188-21" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb188-22"><a href="#cb188-22" tabindex="-1"></a>    start2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-23"><a href="#cb188-23" tabindex="-1"></a>    test2 <span class="ot">&lt;-</span> <span class="fu">NewChisqTest</span>(x, y)</span>
<span id="cb188-24"><a href="#cb188-24" tabindex="-1"></a>    end2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-25"><a href="#cb188-25" tabindex="-1"></a>    end2 <span class="sc">-</span> start2</span>
<span id="cb188-26"><a href="#cb188-26" tabindex="-1"></a>  })</span>
<span id="cb188-27"><a href="#cb188-27" tabindex="-1"></a></span>
<span id="cb188-28"><a href="#cb188-28" tabindex="-1"></a>time3 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb188-29"><a href="#cb188-29" tabindex="-1"></a>  <span class="dv">1000</span>,</span>
<span id="cb188-30"><a href="#cb188-30" tabindex="-1"></a>  <span class="at">expr=</span> {</span>
<span id="cb188-31"><a href="#cb188-31" tabindex="-1"></a>    start3 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-32"><a href="#cb188-32" tabindex="-1"></a>    test3 <span class="ot">&lt;-</span> <span class="fu">NewNewChisqTest</span>(x, y)</span>
<span id="cb188-33"><a href="#cb188-33" tabindex="-1"></a>    end3 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb188-34"><a href="#cb188-34" tabindex="-1"></a>    end3 <span class="sc">-</span> start3</span>
<span id="cb188-35"><a href="#cb188-35" tabindex="-1"></a>  })</span>
<span id="cb188-36"><a href="#cb188-36" tabindex="-1"></a></span>
<span id="cb188-37"><a href="#cb188-37" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">fun=</span><span class="fu">c</span>(<span class="st">&quot;chisq.test&quot;</span>, <span class="st">&quot;New&quot;</span>, <span class="st">&quot;NewNew&quot;</span>), <span class="at">value=</span><span class="fu">c</span>(test1, test2, test3), <span class="at">time=</span><span class="fu">c</span>(<span class="fu">mean</span>(time1), <span class="fu">mean</span>(time2), <span class="fu">mean</span>(time3)))</span></code></pre></div>
<pre><code>##          fun    value         time
## 1 chisq.test 8.931568 0.0004387267
## 2        New 8.931568 0.0002349319
## 3     NewNew 8.931568 0.0001372473</code></pre>
<p>可见结果准确，并且速度更快.</p>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Consider the bivariate density</p>
<p><span class="math display">\[
f(x, y) \propto\binom{n}{x}y^{x+a−1}(1 − y)^{n−x+b−1},\quad x = 0, 1,
\dots , n,\  0 ≤ y ≤ 1.
\]</span> It can be shown that for fixed <span class="math inline">\(a,
b, n\)</span>, the conditional distributions are <span class="math inline">\(\mathrm{Binomial}(n, y)\)</span> and <span class="math inline">\(\mathrm{Beta}(x + a, n − x + b)\)</span>. Write an
Rcpp function using the Gibbs sampler to generate a chain with target
joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<p>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</p>
<p>Campare the computation time of the two functions with the function
“microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a>GibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, a, b, n) {</span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a>  <span class="co"># N: 生成样本数</span></span>
<span id="cb190-3"><a href="#cb190-3" tabindex="-1"></a>  <span class="co"># a, b, n: 目标分布的参数</span></span>
<span id="cb190-4"><a href="#cb190-4" tabindex="-1"></a>  <span class="co"># return: Nx2的矩阵</span></span>
<span id="cb190-5"><a href="#cb190-5" tabindex="-1"></a>  </span>
<span id="cb190-6"><a href="#cb190-6" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>N, <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb190-7"><a href="#cb190-7" tabindex="-1"></a>  z[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb190-8"><a href="#cb190-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb190-9"><a href="#cb190-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb190-10"><a href="#cb190-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb190-11"><a href="#cb190-11" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb190-12"><a href="#cb190-12" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb190-13"><a href="#cb190-13" tabindex="-1"></a>    z[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb190-14"><a href="#cb190-14" tabindex="-1"></a>  }</span>
<span id="cb190-15"><a href="#cb190-15" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb190-16"><a href="#cb190-16" tabindex="-1"></a>}  </span></code></pre></div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20241123</span>)</span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">GibbsR</span>(N, a, b, n)</span>
<span id="cb191-8"><a href="#cb191-8" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">GibbsC</span>(N, a, b, n)</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="fu">qqplot</span>(result1[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>], result2[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>], <span class="at">xlab=</span><span class="st">&quot;GibbsR&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;GibbsC&quot;</span>)</span>
<span id="cb192-2"><a href="#cb192-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="fu">qqplot</span>(result1[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>], result2[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>], <span class="at">xlab=</span><span class="st">&quot;GibbsR&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;GibbsC&quot;</span>)</span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从Q-Q图来看两个函数生成随机数的分布是相近的.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">GibbsR</span>(N, a, b, n),</span>
<span id="cb194-2"><a href="#cb194-2" tabindex="-1"></a>                     <span class="at">gibbC=</span><span class="fu">GibbsC</span>(N, a, b, n))</span>
<span id="cb194-3"><a href="#cb194-3" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr      lq  median      uq
## 1 gibbR 2422.70 2631.35 2869.80
## 2 gibbC  215.25  229.25  244.55</code></pre>
<p>可见GibbsC的速度远远快于GibbsR.</p>
<p>使用C++确实能极大地提高R程序的效率.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
